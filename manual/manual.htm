<html>
<header>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Style-Type" content="text/css">
	<title>turnup readme</title>
	<link rel=stylesheet href="./default.css">
</header>
<body>
<!-- config:term-link-in-header -->			
<!-- config:write-comment -->			
<!-- config:header-numbering 2 4 -->			
<h1><a name='00WaYgs6sy7'></a>README - turnup</h1>
<p>　この文書は、<strong>turnup</strong> のためのマニュアル文書です。</p>
<h2><a name='3Hhcp94tueB'></a>1 Table of contents</h2>
<ul>
<li><a href='#3Hhcp94tueB'>1 Table of contents</a></li>
<li><a href='#dfBhQhXFuAf'>2 turnup とは</a></li>
<li><a href='#fl85VX2ZZgf'>3 用語</a></li>
<li><a href='#lHOzvAtNkez'>4 使い方</a></li>
<li><a href='#6c7fuNVen8Q'>5 記法</a></li>
<ul>
<li><a href='#8w2TpH9N8mf'>5.1 見出し</a></li>
<li><a href='#bigAVFHB4V2'>5.2 箇条書きリスト</a></li>
<li><a href='#g6ShYI41GDs'>5.3 番号付きリスト</a></li>
<li><a href='#h1tEzgBM5pT'>5.4 preブロック</a></li>
<li><a href='#iSO2TEVEGpH'>5.5 テーブル</a></li>
<li><a href='#4n3lxYDUT0F'>5.6 引用</a></li>
<li><a href='#eJX346arix9'>5.7 定義リスト</a></li>
<li><a href='#l2rswZc4S4T'>5.8 コメント</a></li>
<li><a href='#gbRPELCobOc'>5.9 強調</a></li>
<li><a href='#eSWpAeijdti'>5.10 取消し線</a></li>
<li><a href='#16WSNZTDrSg'>5.11 マーカー</a></li>
<li><a href='#fEQY6fCyzn6'>5.12 上付きと下付き</a></li>
<li><a href='#bSYejIfSqoO'>5.13 リンク</a></li>
<li><a href='#2kO0dY0k2Ft'>5.14 コード</a></li>
<li><a href='#fQEJEnGceop'>5.15 水平線</a></li>
<li><a href='#1DN9R32VPmV'>5.16 画像の挿入</a></li>
<li><a href='#dRWRXrsTE69'>5.17 改行の挿入</a></li>
<li><a href='#lH5PaMY4V5R'>5.18 段落</a></li>
</ul>
<li><a href='#fndY0n2YuKG'>6 拡張機能</a></li>
<ul>
<li><a href='#kqWPcKEw070'>6.1 文書タイトルとスタイルシートの指定</a></li>
<li><a href='#2UrqBZiCjSp'>6.2 図と表のタイトル</a></li>
<li><a href='#4YOBqhV2F0K'>6.3 インラインスタイル指定</a></li>
<li><a href='#dx47gXWUrst'>6.4 ページ内へのリンク</a></li>
<li><a href='#3tp71i4aeX5'>6.5 生の HTML の出力</a></li>
<li><a href='#7PU4bw4xAi5'>6.6 脚注</a></li>
<li><a href='#c3xXk4nH9oX'>6.7 目次の生成</a></li>
<li><a href='#g2lU1btb08v'>6.8 図表一覧の生成</a></li>
<li><a href='#8DVv96eWYu2'>6.9 定義リストへの自動リンク</a></li>
<li><a href='#9z4cll3GlNe'>6.10 フィルタ機能</a></li>
<li><a href='#2JSPqxbBwrA'>6.11 外部フィルタの登録</a></li>
<li><a href='#eyMeJ3KtHs6'>6.12 領域の折り畳み</a></li>
<li><a href='#1Jf1lCvlKTy'>6.13 改ページ指定</a></li>
</ul>
<li><a href='#glQDQUruamY'>7 設定</a></li>
<ul>
<li><a href='#2J9QXGdMTue'>7.1 見出しにおける用語の自動リンク</a></li>
<li><a href='#3wlbn0fvvfU'>7.2 見出しの自動ナンバリング</a></li>
<li><a href='#kfUSlZMAzlh'>7.3 図表のナンバリング単位</a></li>
<li><a href='#jXscbg8GSop'>7.4 スタイルシートの埋め込み</a></li>
<li><a href='#4WLnQlG0n9E'>7.5 コメントの出力</a></li>
</ul>
<li><a href='#6Z7lXEj1LuM'>8 細かい話</a></li>
<li><a href='#lUAe8RE7ZCT'>9 更新履歴</a></li>
</ul>
<p>　</p>
<h2><a name='dfBhQhXFuAf'></a>2 turnup とは</h2>
<p>　turnup は、<a class='term' href='#0KfqQD5EbEw'>Markdown</a> 書法で作成したテキストファイルから <a class='term' href='#4ghVmsBLrOx'>HTML</a> を出力するツールです<sup><a name='footnote_ref1' href='#footnote1'>1</a></sup>。このマニュアル文書自体、turnup で作成されています。</p>
<h2><a name='fl85VX2ZZgf'></a>3 用語</h2>
<dl>
  <dt><a name='1NEVpbU4Vzv'></a>GFM</dt>
  <dd>GitHub Flavored <a class='term' href='#0KfqQD5EbEw'>Markdown</a> というものの略語だそうです。turnup は可能な範囲でサポートするように心掛けています。</dd>
</dl>
<dl>
  <dt><a name='0KfqQD5EbEw'></a>Markdown</dt>
  <dd>マークダウンと読みます。<a class='term' href='#4ghVmsBLrOx'>HTML</a> の Mark up をしないで済むという意図なんでしょうけど、命名にセンスが‥‥‥ね。</dd>
</dl>
<dl>
  <dt><a name='4ghVmsBLrOx'></a>HTML</dt>
  <dd>Hyper text markup language の略語です。</dd>
</dl>
<h2><a name='lHOzvAtNkez'></a>4 使い方</h2>
<p>　入力となるファイルの名前をパラメータとして起動してください。生成された <a class='term' href='#4ghVmsBLrOx'>HTML</a> は標準出力に書き出されるので、必要に応じてリダイレクトしてください。</p>
<pre>
  turnup  input.md  &gt;  output.htm
</pre>
<p>　入出力ファイルのエンコーディングは utf-8 で固定となっています。それ以外のエンコーディングへの対応は現状では予定されていません。</p>
<h2><a name='6c7fuNVen8Q'></a>5 記法</h2>
<p>　turnup の入力書式は、基本的には一般的な <a class='term' href='#0KfqQD5EbEw'>Markdown</a> 書法と同じですが、いくつかの拡張機能<sup><a name='footnote_ref2' href='#footnote2'>2</a></sup>を備えています。</p>
<h3><a name='8w2TpH9N8mf'></a>5.1 見出し</h3>
<p>　行頭から１〜６個の # を記述し、続けて（半角）スペースをひとつ書いた行は見出し行になります。後続する文字列が見出しのタイトルとなります。# の数に応じて h1 〜 h6 になります。</p>
<pre>
 # header1
 ## header2
 ### header3
 #### header4
 ##### header5
 ###### header6
</pre>
<p>　<a href='#fndY0n2YuKG'>拡張機能</a>により、<a href='#3wlbn0fvvfU'>見出しに番号を自動付与</a>したり、<a href='#c3xXk4nH9oX'>見出しから目次を生成</a>したりできます。</p>
<h3><a name='bigAVFHB4V2'></a>5.2 箇条書きリスト</h3>
<p>　-（ハイフン）、+（プラス）、または *（アスタリスク）にスペースを後続させると、箇条書きリストになります。ネストさせたい場合は、行頭にタブ文字を使用してください。</p>
<pre>
- List A
+ List B
	* List B - 1
	- List B - 2
		+ List B - 2 - 1
		* List B - 2 - 2
- List C
</pre>
<p>　上記は、以下のように出力されます。</p>
<ul>
<li>List A</li>
<li>List B</li>
<ul>
<li>List B - 1</li>
<li>List B - 2</li>
<ul>
<li>List B - 2 - 1</li>
<li>List B - 2 - 2</li>
</ul>
</ul>
<li>List C</li>
</ul>
<p>　また、- などの先頭記号とスペースに続けて [ ] や [X] を記述すると、チェックボックス付きリストになります。</p>
<pre>
- Task list
	- [X] completed task
		* point 1
		* point 2
	- [ ] not completed task
</pre>
<p>　上記は、以下のように出力されます。</p>
<ul>
<li>Task list</li>
<ul>
<li style='list-style-type:none;'><input type='checkbox' onclick='return false;'>completed task</li>
<ul>
<li>point 1</li>
<li>point 2</li>
</ul>
<li style='list-style-type:none;'><input type='checkbox' onclick='return false;' checked>not completed task</li>
</ul>
</ul>
<h3><a name='g6ShYI41GDs'></a>5.3 番号付きリスト</h3>
<p>　数字にピリオドとスペースを後続させると、番号付きリストになります。ネストさせたい場合は、行頭にタブ文字を使用してください。</p>
<pre>
1. List A
1. List B
	1. List B - 1
	1. List B - 2
		1. List B - 2 - 1
1. List C
</pre>
<p>　上記は、以下のように出力されます。</p>
<ol>
<li>List A</li>
<li>List B</li>
<ol>
<li>List B - 1</li>
<li>List B - 2</li>
<ol>
<li>List B - 2 - 1</li>
</ol>
</ol>
<li>List C</li>
</ol>
<h3><a name='h1tEzgBM5pT'></a>5.4 preブロック</h3>
<p>　バッククォート3つ、またはチルダ3つだけからなる行で囲まれたブロックは &lt;pre&gt; ブロックとなります。<sup><a name='footnote_ref3' href='#footnote3'>3</a></sup></p>
<pre>
~~~
int main( void ) {
    std::cout &lt;&lt; "hello world." &lt;&lt; std::endl;
    return 0;
}
~~~
</pre>
<p>　上記は、以下のように出力されます。</p>
<pre>
int main( void ) {
    std::cout &lt;&lt; "hello world." &lt;&lt; std::endl;
    return 0;
}
</pre>
<p>　拡張機能として、preブロックを開始する行に言語などの名前をつけることでコードハイライトをする機能もあります。これについての詳細は<a href='#9z4cll3GlNe'>6.10  フィルタ機能</a>を参照してください。</p>
<h3><a name='iSO2TEVEGpH'></a>5.5 テーブル</h3>
<p>　以下のような記述でテーブルを作成できます。１行目は常にヘッダ（th タグ）であり、各列の中央揃え、右寄せなどを制御したい場合には ２行目に :---: や ---: を記述します。<sup><a name='footnote_ref4' href='#footnote4'>4</a></sup></p>
<pre>
	| header A | header B | header C |	
	| :------- | :------: | -------: |	
	|     0    |     1    |    2     |	
	|     3    |     4    |    5     |	
	|     6    |     7    |    8     |	
</pre>
<p>　上記は、以下のように出力されます（表は常にセンタリングされます）。</p>
<table align='center'>
<tr><th>header A</th><th>header B</th><th>header C</th></tr>
<tr><td align='left'>0</td><td align='center'>1</td><td align='right'>2</td></tr>
<tr><td align='left'>3</td><td align='center'>4</td><td align='right'>5</td></tr>
<tr><td align='left'>6</td><td align='center'>7</td><td align='right'>8</td></tr>
</table>
<p>　拡張機能として、２行目に記述する :---: や ---: では、- のかわりに = を使用することができます。<code>:====:</code> などとした場合、その列は nowrap 指定が追加され、「自動的な折り返し」を禁止することができます<sup><a name='footnote_ref5' href='#footnote5'>5</a></sup>。</p>
<h3><a name='4n3lxYDUT0F'></a>5.6 引用</h3>
<p>　行頭を &gt; で始めると引用になります。複数の &gt; 連続させると多段の引用になります。<sup><a name='footnote_ref6' href='#footnote6'>6</a></sup></p>
<pre>
&gt; lv.1 - 1
&gt; lv.1 - 2
&gt;&gt; lv.2 - 1
&gt;&gt; lv.2 - 2
&gt;&gt;&gt; lv.3
&gt; lv.1
&gt;&gt;&gt;&gt; lv.4
&gt;&gt; lv.2
</pre>
<p>　上記は、以下のように出力されます。</p>
<blockquote>
lv.1 - 1<br>
lv.1 - 2<br>
<blockquote>
lv.2 - 1<br>
lv.2 - 2<br>
<blockquote>
lv.3<br>
</blockquote>
</blockquote>
lv.1<br>
<blockquote>
<blockquote>
<blockquote>
lv.4<br>
</blockquote>
</blockquote>
lv.2<br>
</blockquote>
</blockquote>
<h3><a name='eJX346arix9'></a>5.7 定義リスト</h3>
<p>　以下のような記述により、定義リストを作成できます。turnup では、これによって定義された用語は<a href='#8DVv96eWYu2'>自動リンク</a>の対象となります。</p>
<pre>
  *[用語]: 用語の定義をここに記述します。
  複数行に渡る定義も記述できます。空行で終わります。

</pre>
<p>　上記は、以下のように出力されます。</p>
<!-- start raw html -->
<dl>
  <dt>用語</dt>
  <dd>用語の定義をここに記述します。複数行に渡る定義も記述できます。空行で終わります。</dd>
</dl>
<!-- end raw html -->
<p>　[ と ] に囲まれた用語は、前後のスペースは無視されますが、途中にあるスペースは用語の一部とみなされます。</p>
<h3><a name='l2rswZc4S4T'></a>5.8 コメント</h3>
<p>　turnup は、以下のような <a class='term' href='#4ghVmsBLrOx'>HTML</a> 形式のコメントをコメントとして扱います。つまり、出力される <a class='term' href='#4ghVmsBLrOx'>HTML</a> の内容には含まれません。</p>
<!-- start raw html -->
<pre>
  &lt;!-- comment --&gt;

  &lt;!--
    multi
    line
    comment
  --&gt;
</pre>
<!-- end raw html -->
<p>　ただし、この挙動は変更することができます。<a href='#4WLnQlG0n9E'>write-comment設定</a>を参照してください。</p>
<h3><a name='gbRPELCobOc'></a>5.9 強調</h3>
<p>　1 〜 3 個の連続するアスタリスクまたはアンダースコアで括ることにより、文字列を強調することができます。どのように表示されるのかは、スタイルシート次第です。</p>
<ul>
<li>１つだと、em タグによる強調になります。<code>*これ*</code>が、<em>これ</em> になります。</li>
<li>２つだと、strong タグによる強調になります。<code>**これ**</code>が、<strong>これ</strong> になります。</li>
<li>３つだと、em と strong の併用になります。<code>***これ***</code>が、<em><strong>これ</strong></em> になります。</li>
</ul>
<h3><a name='eSWpAeijdti'></a>5.10 取消し線</h3>
<p>　２つのチルダ ~~ で括ることで、文字列に取消線を引くことができます。<code>~~この部分は取消し~~</code>が、<strike>この部分は取消し</strike>になります。</p>
<h3><a name='16WSNZTDrSg'></a>5.11 マーカー</h3>
<p>　== を使って括ることで、マーカーを利用することができます。スタイルシート次第ですが、<code>==例えばこんなふう==</code>が、<mark>例えばこんなふう</mark>になります。</p>
<h3><a name='fEQY6fCyzn6'></a>5.12 上付きと下付き</h3>
<p>　単一の ^ および ~ で括ると、文字列を上付きと下付きにできます。たとえば <code>H~2~O</code> は H<sub>2</sub>O に、<code>2^10^ = 1024</code> は 2<sup>10</sup> = 1024 になります。</p>
<h3><a name='bSYejIfSqoO'></a>5.13 リンク</h3>
<p>　文章中で以下のような書き方をすることで、URL へのリンクを貼ることができます。<sup><a name='footnote_ref7' href='#footnote7'>7</a></sup></p>
<pre>
  [テキスト](URL)
</pre>
<p>　たとえば、<code>[Google](https://www.google.co.jp/)</code> は <a href='https://www.google.co.jp/'>Google</a> となります。テキスト部分を省略すると、URL がそのまま表示されます。つまり、<code>[](https://www.google.co.jp/)</code> は <a href='https://www.google.co.jp/'>https://www.google.co.jp/</a> となります。</p>
<p>　拡張機能として、ページ内の見出しや図表タイトルへのリンクを作成することもできます。<a href='#dx47gXWUrst'>6.4  節</a>を参照してください。</p>
<h3><a name='2kO0dY0k2Ft'></a>5.14 コード</h3>
<p>　文章中では、以下のようにバッククォートで括ることで、囲まれた部分をコードとして表示させられます。この内部にある文字列は、用語の自動リンクやその他の文字装飾は実行されません。</p>
<pre>
  `code`
</pre>
<h3><a name='fQEJEnGceop'></a>5.15 水平線</h3>
<p>　行頭からハイフン、等号、アンダースコア、アスタリスクを３個以上を記述すると水平線として出力されます。文字種は混在させないでください。</p>
<h3><a name='1DN9R32VPmV'></a>5.16 画像の挿入</h3>
<p>　画像を表示させるには、以下のように記述します。独立した行として記述することもできますし、文章中にインラインで挿入させることもできます。</p>
<pre>
  ![代替テキスト](画像URL)
</pre>
<p>　上記は、以下のように展開されます。なお、代替テキストは省略できます。</p>
<pre>
  &lt;img src='画像URL' alt='代替テキスト' /&gt;
</pre>
<h3><a name='dRWRXrsTE69'></a>5.17 改行の挿入</h3>
<p>　文中で改行させるには、<a class='term' href='#4ghVmsBLrOx'>HTML</a> タグ <code>&lt;br&gt;</code> をそのまま書きます。</p>
<h3><a name='lH5PaMY4V5R'></a>5.18 段落</h3>
<p>　拡張機能を含め、他の書法と認識されない行はすべて段落の開始とみなされます。段落は空行または<a href='#l2rswZc4S4T'>コメント</a>行に至るまでのすべての行が連結され、単一の段落として出力されます。</p>
<p>　 　 </p>
<h2><a name='fndY0n2YuKG'></a>6 拡張機能</h2>
<p>　turnup には、いくつかの拡張機能があります。一般的な <a class='term' href='#0KfqQD5EbEw'>Markdown</a> の書法からは逸脱しますが、文書作成に必要と判断して追加しているものです。</p>
<h3><a name='kqWPcKEw070'></a>6.1 文書タイトルとスタイルシートの指定</h3>
<p>　データファイルの冒頭に以下のようなコメントを記述することで、出力される <a class='term' href='#4ghVmsBLrOx'>HTML</a> ファイルのヘッダに設定するタイトルとスタイルシートを指定することができます。</p>
<pre>
  &lt;!-- title:Document title --&gt;
  &lt;!-- style:./default.css --&gt;
</pre>
<p>　このうち、スタイルシートの指定は設定の影響を受けます。詳細は<a href='#jXscbg8GSop'>embed-stylesheet設定</a>を参照してください。</p>
<h3><a name='2UrqBZiCjSp'></a>6.2 図と表のタイトル</h3>
<p>　図と表には、専用のタイトルをつけることができます。図（大抵は画像を表示させるという意味ですが）の場合、以下のように行頭に <code>Figure.</code> を、それに続いてタイトルを書きます。</p>
<pre>
![](some-figure.png)
Figure. title of figure
</pre>
<p>　表の場合は行頭に <code>Table.</code> を、それに続いてタイトルを書きます。</p>
<pre>
Table. title of table
| header1 | header2 |
| :------ | :-----: |
|    0    |    1    |
|    2    |    3    |
</pre>
<p>　この方法でタイトルをつけておけば、同じく拡張機能の<a href='#g2lU1btb08v'>図表一覧の生成</a>機能で一覧を生成することができます。</p>
<p>　見出しと同様に、図表のタイトルには自動的に番号付けを行なうことができます。詳細は「<a href='#kfUSlZMAzlh'>7.3  図表のナンバリング単位</a>」を参照してください。</p>
<h3><a name='4YOBqhV2F0K'></a>6.3 インラインスタイル指定</h3>
<p>　文章中などで部分的に文字色やその他のスタイルを指定したい場合、インラインスタイル指定が使用できます。以下のような書法で、<code>STYLES</code> 部分には <a class='term' href='#4ghVmsBLrOx'>HTML</a> の style に指定する内容をそのまま記述します。</p>
<pre>
 @{{STYLES}{CONTETS}}
</pre>
<p>　上記は、<code>&lt;span style='STYLES'&gt;CONTENTS&lt;/span&gt;</code> のように展開されます。たとえば、<code>@{{background:red; color:white;}{赤地の白抜き}}</code> が<span style='background:red; color:white;'>赤地の白抜き</span>になります。</p>
<h3><a name='dx47gXWUrst'></a>6.4 ページ内へのリンク</h3>
<p>　リンクの書法を拡張することで、ページ内の<a href='#8w2TpH9N8mf'>見出し</a>や<a href='#2UrqBZiCjSp'>図表タイトル</a>へのリンクを作成することができます。</p>
<p>　ページ内の見出しへのリンクを作成する場合、URL 部分を # に続けて見出しの名前にしてください。たとえば、<code>[目次](#Table of contents)</code> は<a href='#3Hhcp94tueB'>目次</a>となります。テキスト部分を省略した場合のルールは標準的な URL リンクと同じですが、<a href='#3wlbn0fvvfU'>見出しの自動ナンバリング</a>を設定している場合、番号付けされた見出し名がリンクのテキストとなることに注意してください。つまり、<code>[](#Table of contents)</code> は<a href='#3Hhcp94tueB'>1  Table of contents</a>となります。</p>
<p>　図表タイトルへのリンクを作成するには、（ちょっと無様ですが）以下のように F#, T# に続けてタイトルを記述します。それ以外のルールは見出しへのリンクと同じです。</p>
<pre>
  [テキスト](F#図のタイトル)
  [テキスト](T#表のタイトル)
</pre>
<p>　さらに、テキスト部分では <code>$@</code>, <code>$$</code> を使うことができます。これらは、以下のように展開されます。</p>
<ul>
<li><code>$@</code> : 自動ナンバリングによって付与されるプレフィクス</li>
<li><code>$$</code> : 見出しや図表タイトルの文字列</li>
</ul>
<h3><a name='3tp71i4aeX5'></a>6.5 生の <a class='term' href='#4ghVmsBLrOx'>HTML</a> の出力</h3>
<p>　以下のように記述することで、生の <a class='term' href='#4ghVmsBLrOx'>HTML</a> をそのまま出力することができます。</p>
<pre>
  &lt;raw_html&gt;
      :
      :
  &lt;/raw_html&gt;
</pre>
<h3><a name='7PU4bw4xAi5'></a>6.6 脚注</h3>
<p>　文章中に脚注を設定し、一箇所にまとめて表示させることができます。開始を示す <code>{{fn:</code> と終了を示す <code>}}</code> は同一の行に記述する必要があることに注意してください。</p>
<pre>
  {{fn:これが脚注の内容です。}}
</pre>
<p>　脚注をまとめて表示するには、脚注を展開したい場所（通常は登場文書の末尾でしょう）に以下の行を記述します。これにより、その場所に文書内のすべての脚注が記載順で一覧されます。</p>
<pre>
  &lt;!-- embed:footnotes --&gt;
</pre>
<p>　このマニュアル文書でも、いくつかの脚注を（サンプルを兼ねて）使用しています。文書末尾を参照してください。</p>
<h3><a name='c3xXk4nH9oX'></a>6.7 目次の生成</h3>
<p>　見出し情報から目次を生成することができます。以下のように記述すると、その場所に階層化されたリストの形式で目次が作成されます。</p>
<pre>
  &lt;!-- embed:toc --&gt;
</pre>
<p>　上記の指定では、見出しレベルの１から６までが全て目次化の対象になります。この対象範囲を絞るには、以下のように記述します。</p>
<pre>
  &lt;!-- embed:toc 2 4 --&gt;
</pre>
<p>　この例では、見出しレベル２〜４までが目次化の対象となります。</p>
<h3><a name='g2lU1btb08v'></a>6.8 図表一覧の生成</h3>
<p>　目次と同様、図と表の一覧を生成することができます。以下のように記述すると、その場所に図の一覧が作成されます。</p>
<pre>
  &lt;!-- embed:figure-list --&gt;
</pre>
<p>　表の一覧の場合は以下です。</p>
<pre>
  &lt;!-- embed:table-list --&gt;
</pre>
<p>　これによって生成される一覧でも、<a href='#2UrqBZiCjSp'>図表タイトル</a>と同じ設定でナンバリングが行なわれます。詳細は「<a href='#kfUSlZMAzlh'>7.3  図表のナンバリング単位</a>」を参照してください。</p>
<h3><a name='8DVv96eWYu2'></a>6.9 定義リストへの自動リンク</h3>
<p>　<a href='#eJX346arix9'>定義リスト</a>をつかって用語を定義すると、文章中に登場したその用語は自動的に定義箇所へのリンクになります。このマニュアル文書では、「<a href='#fl85VX2ZZgf'>3  用語</a>」というセクションで（サンプルを兼ねて）いくつかの用語を定義しているので、たとえば <a class='term' href='#0KfqQD5EbEw'>Markdown</a> という用語は自動的にリンクされます。<sup><a name='footnote_ref8' href='#footnote8'>8</a></sup></p>
<p>　この拡張機能に関与する設定として、<a href='#2J9QXGdMTue'>見出しにおける用語の自動リンク</a>があります。</p>
<h3><a name='9z4cll3GlNe'></a>6.10 フィルタ機能</h3>
<p>　<a href='#h1tEzgBM5pT'>preブロック</a>を開始する行に言語などの名前をつけることでコードハイライトをすることができます。これは turnup では<strong>フィルタ機能</strong>と呼ばれ、コードハイライトに限らずブロックの中身に様々な変換をかける仕組みとして位置付けられています。たとえば、diff の出力に色付けをしたければ以下のように記述します。</p>
<pre>
~~~diff
diff --git a/main.cxx b/main.cxx
index 16fc9f4..8387187 100644
--- a/main.cxx
+++ b/main.cxx
@@ -3,5 +3,5 @@ int main( void ) {
 
-    printf( "hello world.\n" );
+    std::cout &lt;&lt; "hello world." &lt;&lt; std::endl;

    return 0;
~~~
</pre>
<p>　これは以下のように表示されます。</p>
<pre class='diff'>
<span class='diff_head'>diff --git a/main.cxx b/main.cxx</span>
<span class='diff_head'>index 16fc9f4..8387187 100644</span>
<span class='diff_head'>--- a/main.cxx</span>
<span class='diff_head'>+++ b/main.cxx</span>
<span class='diff_line'>@@ -3,5 +3,5 @@ int main( void ) {</span>
 
<span class='diff_del'>-    printf( "hello world.\n" );</span>
<span class='diff_add'>+    std::cout &lt;&lt; "hello world." &lt;&lt; std::endl;</span>

    return 0;
</pre>
<p>　現在、turnup が提供しているフィルタは以下の通りです。つまり、<strong>まだちょっとしか実装されていません</strong><sup><a name='footnote_ref9' href='#footnote9'>9</a></sup>。</p>
<ul>
<li>C</li>
<li>C++</li>
<li>diff</li>
</ul>
<p>　しかし、拡張機能として外部プログラムを用いたフィルタリングが可能となっています。詳しくは、<a href='#2JSPqxbBwrA'>6.11  外部フィルタの登録</a>を参照してください。また内蔵のフィルタ機能については<a href='#6Z7lXEj1LuM'>細かい話</a>があります。</p>
<h3><a name='2JSPqxbBwrA'></a>6.11 外部フィルタの登録</h3>
<p>　<a href='#h1tEzgBM5pT'>preブロック</a> で指定するフィルタとして、外部プログラムを追加することができます。たとえば、foo というフィルタを指定した場合に quux プログラムを通した結果を表示させたければ以下のように指定します。</p>
<pre>
  &lt;!-- filter:foo = quux %in %out --&gt;
</pre>
<p>　ここで <code>&lt;!-- filter:</code> の直後から <code>=</code> まで（ここでは <code>foo</code> ）がフィルタ名、<code>=</code> から 最後の <code>--&gt;</code> の手前まで（ここでは <code>quux %in %out</code> ）が実行するフィルタプログラムです。%in と %out は入力ファイル名と出力ファイル名のプレースホルダで、実際に使用されるファイル名は turnnup が都度決定します。</p>
<p>　上記のように定義されていると、turnup はフィルタ名として foo が指定された preブロックを見つけた場合に、以下の要領で処理を行ないます。</p>
<ul>
<li>pre ブロックの中身を一時ファイルに保存する</li>
<li>フィルタプログラムの定義に従い、<code>quux %in %out</code> を実行する</li>
<ul>
<li>この時、preブロックの中身を保存した一時ファイル名で %in を置き換える</li>
<li>同様に、%out を別の一時ファイル名で置き換える</li>
</ul>
<li>%out に指定した一時ファイルの内容を読み込み、preブロックのフィルタ結果として出力する</li>
</ul>
<p>　外部フィルタは turnup が提供するフィルタ機能よりも優先度が高いことに注意してください。同じ名前のフィルタがある場合、外部フィルタが優先されます。</p>
<h3><a name='eyMeJ3KtHs6'></a>6.12 領域の折り畳み</h3>
<p>　以下のように 2 つのコメントで囲まれた部分は、折り畳み可能な領域になります。その最初の行は常に表示されるタイトルで、クリックするたびに表示状態を切り替えることができます。２行目以降は折り畳まれる部分です。</p>
<pre>
  &lt;!-- collapse:begin --&gt;
  TITLE_LINE
      :
      : (contents)
      :
  &lt;!-- collapse:end --&gt;
</pre>
<p>　　</p>
<p>　以下に例を示します。あと、<a href='#6Z7lXEj1LuM'>細かい話</a>にも注意事項が書いてありますので参照してください。</p>
<details>
<summary>この行はタイトルです。クリックするたびに折り畳み状態をトグルできます。</summary>
<p>２行目以降は折り畳まれる中身です。通常通り、様々な記述をすることができます。</p>
<ul>
<li>contents1</li>
<li>contents2</li>
<li>contents3</li>
</ul>
</details>
<h3><a name='1Jf1lCvlKTy'></a>6.13 改ページ指定</h3>
<p>　以下のコメントを記述することで、印刷時にその位置で改ページをすることができます。<sup><a name='footnote_ref10' href='#footnote10'>10</a></sup></p>
<pre>
&lt;!-- embed:pagebreak --&gt;
</pre>
<p>　　</p>
<h2><a name='glQDQUruamY'></a>7 設定</h2>
<h3><a name='2J9QXGdMTue'></a>7.1 見出しにおける用語の自動リンク</h3>
<p>　<a href='#8DVv96eWYu2'>定義リストへの自動リンク</a>機能は、デフォルトでは見出し文字列には適用されません。これは見出し内にリンクを生成するとうるさくなることや、見出しに存在する文字列は通常そのセクションの本文にも存在することが理由です。</p>
<p>　この挙動を変えたい場合、以下の行を文書内に記載してください。見出し文字列内でも用語の自動リンクが行なわれるようになります。</p>
<pre>
  &lt;!-- config:term-link-in-header --&gt;			
</pre>
<h3><a name='3wlbn0fvvfU'></a>7.2 見出しの自動ナンバリング</h3>
<p>　見出しに自動的に番号付けを行なうことができます。この機能を有効化するには、以下の設定を文書内に記載します。</p>
<pre>
  &lt;!-- config:header-numbering --&gt;			
</pre>
<p>　これにより、1.1.1. 形式で見出しに自動的に番号が付与されます<sup><a name='footnote_ref11' href='#footnote11'>11</a></sup>。この番号を付与する見出しのレベルを限定したい場合、以下のように記載します。この例では、見出しレベル２〜４の合計３レベルで採番されます。この場合、見出しレベル1、および 5 以降には番号付けは適用されません。</p>
<pre>
  &lt;!-- config:header-numbering 2 4 --&gt;			
</pre>
<h3><a name='kfUSlZMAzlh'></a>7.3 図表のナンバリング単位</h3>
<p>　<a href='#2UrqBZiCjSp'>図表タイトル</a>、および<a href='#g2lU1btb08v'>図表一覧生成</a>に適用される番号付けの規則を設定することができます。これには、以下のように記述します。この設定を省略した場合のデフォルト値は 0 です。</p>
<pre>
  &lt;!-- config:entity-numbering-depth 1 --&gt;
</pre>
<p>　0 が指定された場合、図と表それぞれについて、文書全体を通して 1 から始まる連番が付与されます。つまり、図であれば Figure.1 xxxxx、Figure.2 yyyyy といった要領です（表の場合は Table.1 zzzzz）となります。</p>
<p>　1 以上を指定した場合、「<a href='#3wlbn0fvvfU'>7.2  見出しの自動ナンバリング</a>」で指定した番号付け対象の見出しのうち、先頭から指定した数のレベルを単位として 1 から始まる番号付けを行ないます。こう書くとわかりにくいですが、たとえば以下のようにした場合、</p>
<pre>
  &lt;!-- config:header-numbering 2 4 --&gt;			
  &lt;!-- config:entity-numbering-depth 2 --&gt;
</pre>
<p>まず、ナンバリングをする見出しはレベル 2,3,4 です。そして、図表については見出しレベルの 2,3 が一致するものについて 1 から連番で番号付けをし、これらの見出しレベルが変化するとまた 1 からナンバリングが始まります。なお、この場合は図であれば Figure.1.2-1 xxxxxx といった書式になります。</p>
<h3><a name='jXscbg8GSop'></a>7.4 スタイルシートの埋め込み</h3>
<p>　<a href='#kqWPcKEw070'>スタイルシートの指定</a>は、デフォルトではスタイルシートの参照が出力されるだけですが、以下の設定が文書内に記述されていると、出力 <a class='term' href='#4ghVmsBLrOx'>HTML</a> の内部にスタイルシートの内容を埋め込むようになります。</p>
<pre>
  &lt;!-- config:embed-stylesheet --&gt;			
</pre>
<p>　これによって、以下のように埋め込みが行なわれます。</p>
<pre>
&lt;html&gt;
&lt;header&gt;
	&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
	&lt;meta http-equiv="Content-Style-Type" content="text/css"&gt;
	&lt;title&gt;document title&lt;/title&gt;
  &lt;style&gt;
  &lt;!--
    :
    :
  --&gt;
  &lt;/style&gt;
&lt;/header&gt;
</pre>
<p>　この設定を有効にしてスタイルシートの埋め込みを行なう場合、turnup の実行時点で指定されたスタイルシートのファイルが存在していなければなりません（当たり前ですが）。</p>
<h3><a name='4WLnQlG0n9E'></a>7.5 コメントの出力</h3>
<p>　<a href='#l2rswZc4S4T'>コメント</a>は記述しても <a class='term' href='#4ghVmsBLrOx'>HTML</a> には出力されませんが、以下の設定を文書内に記述することで、この挙動を変えることができます。具体的には、<a class='term' href='#4ghVmsBLrOx'>HTML</a> スタイルのコメントをそのまま出力するようになります。<sup><a name='footnote_ref12' href='#footnote12'>12</a></sup></p>
<pre>
  &lt;!-- config:write-comment --&gt;			
</pre>
<p>　　</p>
<h2><a name='6Z7lXEj1LuM'></a>8 細かい話</h2>
<ul>
<li>文章中に記述できる各種の装飾、リンクなどは、行を跨ぐことはできないので注意してください。</li>
</ul>
<ul>
<li>turnup が標準で提供する<a href='#9z4cll3GlNe'>フィルタ機能</a>は簡易的なもので、せいぜいコメントと文字列リテラルなどを優先して処理し、あとはキーワードをハイライトする程度です。構文解析などを伴うリッチなコードハイライトが必要な場合、<a href='#2JSPqxbBwrA'>外部フィルタの利用</a>を検討してください。</li>
</ul>
<ul>
<li><a href='#eyMeJ3KtHs6'>領域の折り畳み</a>を可能にする拡張は、スクリプトを使わず、&lt;details&gt; タグを使って実現しています。ひょっとしたら、古いブラウザでは動作しないかもしれません。あと、折り畳まれる対象の中で<a href='#7PU4bw4xAi5'>脚注</a>を使った場合、畳まれた状態では脚注からのリンクをクリックしてもジャンプしないことがわかっていますので注意してください。</li>
</ul>
<ul>
<li>他、何か思いついたら記載します。</li>
</ul>
<p>　　</p>
<h2><a name='lUAe8RE7ZCT'></a>9 更新履歴</h2>
<p>　更新履歴です。バージョン番号の付与はまだ行なっていません。</p>
<ul>
<li><strong>2021/07/23</strong></li>
<ul>
<li>ENHANCE : <a href='#2JSPqxbBwrA'>外部フィルタ</a>機構の導入</li>
<li>REFACTORING : 内部的な修正</li>
</ul>
<li><strong>2021/07/27</strong></li>
<ul>
<li>BUGFIX : <a href='#2JSPqxbBwrA'>外部フィルタ</a>を使用する場合の一時ファイル保存にまつわるバグを修正</li>
<li>ENHANCE : <a href='#2UrqBZiCjSp'>図表タイトル</a>の記法と一覧作成機能の実装</li>
</ul>
<li><strong>2021/07/28</strong></li>
<ul>
<li>ENHANCE : <a href='#7PU4bw4xAi5'>脚注</a>に専用の class を用意</li>
<li>ENHANCE : <a href='#dx47gXWUrst'>ページ内アンカーへのリンク</a>に省略記法を用意</li>
</ul>
<li><strong>2021/07/29</strong></li>
<ul>
<li>BUGFIX : 単独の ! が [ に化ける凡ミスを修正</li>
</ul>
<li><strong>2021/08/12</strong></li>
<ul>
<li>ENHANCE : <a href='#9z4cll3GlNe'>diff のハイライト</a>を内部フィルタとして実装</li>
</ul>
<li><strong>2021/08/15</strong></li>
<ul>
<li>ENHANCE : <a href='#9z4cll3GlNe'>C/C++ のコードハイライト</a>を内部フィルタとして実装</li>
</ul>
<li><strong>2021/08/16</strong></li>
<ul>
<li>BUGFIX : <a href='#9z4cll3GlNe'>コードハイライト</a>対象冒頭にキーワードがあると処理されない問題の修正</li>
<li>BUGFIX : <a href='#iSO2TEVEGpH'>テーブル</a>ヘッダ行にも align が出力される問題の修正</li>
<li>CSS : table header の背景色スタイルを変更</li>
<li>ENHANCE : <a href='#1Jf1lCvlKTy'>改ページ指定</a>の機能を追加</li>
</ul>
<li><strong>2021/08/17</strong></li>
<ul>
<li>ENHANCE : <a href='#iSO2TEVEGpH'>テーブル</a>と<a href='#1DN9R32VPmV'>画像</a>は常にセンタリングされるように変更（暫定対処になるかも）</li>
<li>ENHANCE : <a href='#dRWRXrsTE69'>改行の挿入</a>をサポート</li>
<li>ENHANCE : <a href='#eJX346arix9'>定義リスト</a>において用語の前後のスペースの扱いを緩和し、明確化</li>
<li>ENHANCE : <a href='#4YOBqhV2F0K'>インラインスタイル指定</a>のサポートを追加</li>
<li>ENHANCE : <a href='#iSO2TEVEGpH'>テーブル</a>で nowrap を指定させる拡張を追加</li>
<li>ENHANCE : <a href='#eyMeJ3KtHs6'>領域の折り畳み</a>を可能にする拡張を追加</li>
</ul>
<li><strong>2021/08/18</strong></li>
<ul>
<li>BUGFIX : リンクラベル内部に定義用語があるとリンクがネストする問題の修正</li>
<li>ENHANCE : 空行に加えてコメント行も段落の終了とみなすように変更</li>
<li>BUGFIX : 各種タイトル（見出し、テーブル、ヘッダ）、および用語が同名でも異なるリンク用ハッシュコードを生成するように修正</li>
</ul>
</ul>
<hr>
<p class='footnote'><a name='footnote1' href='#footnote_ref1'>1</a> : turnupという名前は、mark down を mark up にひっくり返す(turn upする)という意味で付けられました。</p>
<p class='footnote'><a name='footnote2' href='#footnote_ref2'>2</a> : <code>GitHub Flavored Markdown</code> とか色々あるみたいで、何が標準なのか良くわかりませんが。</p>
<p class='footnote'><a name='footnote3' href='#footnote_ref3'>3</a> : スペースまたはタブで始まる行を pre ブロックとする仕様は採用していません</p>
<p class='footnote'><a name='footnote4' href='#footnote_ref4'>4</a> : この２行目の記述は省略できます。その場合、すべての列がデフォルトの左寄せになります。</p>
<p class='footnote'><a name='footnote5' href='#footnote_ref5'>5</a> : = と - を混在させた場合、従来通り nowrap ではないものとみなされます。</p>
<p class='footnote'><a name='footnote6' href='#footnote_ref6'>6</a> : 現在の実装では &gt; は行頭から始める必要があり、また複数の &gt; の間に空白を入れることはできません。これは課題として将来修正される可能性があります。</p>
<p class='footnote'><a name='footnote7' href='#footnote_ref7'>7</a> : <a class='term' href='#1NEVpbU4Vzv'>GFM</a> だと URL を単純に書いただけでもリンクになるようですが、そこまではしてません。</p>
<p class='footnote'><a name='footnote8' href='#footnote_ref8'>8</a> : この自動リンクにおいて、大文字小文字が異なる表記は対象になりません。この挙動を変更するオプションは今のところ、ありません。</p>
<p class='footnote'><a name='footnote9' href='#footnote_ref9'>9</a> : C/C++ のコードハイライト実装で基本的な仕組みはできているので、必要に応じて他も実装する予定です。</p>
<p class='footnote'><a name='footnote10' href='#footnote_ref10'>10</a> : 実際には、これは <code>&lt;p class='pagebreak'&gt;&lt;/p&gt;</code> という一行を出力 <a class='term' href='#4ghVmsBLrOx'>HTML</a> に書き出すだけで、これが改ページとして機能するのは、CSS の設定によるものです。詳細は同梱の default.css に含まれる <code>p.pagebreak</code> という CSS エントリを参照してください。</p>
<p class='footnote'><a name='footnote11' href='#footnote_ref11'>11</a> : 番号付けの書式は今のところこれだけで、選択はできません。</p>
<p class='footnote'><a name='footnote12' href='#footnote_ref12'>12</a> : それの何が嬉しいのかわからないかもしれませんが、作者にも良くわからない機能なので気にしないでください。おそらく、どのような設定で turnup が動作したのかわかるように、とかだと思います。</p>
</body>
</html>
