<html>
<header>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta http-equiv="Content-Style-Type" content="text/css">
	<title>turnup readme</title>
	<link rel=stylesheet href="./default.css">
</header>
<body>
<div class='toc_button_top'><a href='#0qJQvVjc3Xy'>
<svg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 200 200'>
<defs><g id='line'>
  <circle cx='45' cy='50' r='15' fill='white' stroke='none' stroke-width='1' />
  <polyline fill='none' stroke='white' stroke-width='20' points=' 75.0,50.0 170.0,50.0' />
</g></defs>
<rect x='0' y='0' width='200' height='200' rx='30' ry='30' fill='lightgray' stroke='none' stroke-width='1' />
<use xlink:href='#line' x='0' y='0' />
<use xlink:href='#line' x='0' y='50' />
<use xlink:href='#line' x='0' y='100' />
</svg>
</a></div>
<h1><a name='iI4sykJQemx'></a>README - turnup</h1>
<p>　この文書は、 <strong>turnup</strong> のマニュアル文書です。</p>
<h2><a name='0qJQvVjc3Xy'></a>1 Table of contents</h2>
<li class='tocx'><a href='#0qJQvVjc3Xy'>1 Table of contents</a></li>
<li class='tocx'><a href='#ii4jRxV2ffy'>2 turnup とは</a></li>
<li class='tocx'><a href='#dcPEbaWhYMa'>3 用語</a></li>
<li class='tocx'><a href='#h1vILBov6aJ'>4 使い方</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#8wGebtcPJwd'>5 記法</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#7HkxqP1TWY5'>5.1 見出し</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#jGghWL1I5CM'>5.2 箇条書きリスト</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#5cVofWIxtWQ'>5.2.1 リスト要素における改行</a></li>
<li class='tocx'><a href='#04sRz8Off9s'>5.2.2 チェックボックス付きのリスト</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#iYSlVZhYmRM'>5.3 番号付きリスト</a></li>
<li class='tocx'><a href='#2HUs4TZfCPd'>5.4 preブロック</a></li>
<li class='tocx'><a href='#g6xjP526KX7'>5.5 テーブル</a></li>
<li class='tocx'><a href='#2c4WKrG50Sg'>5.6 引用</a></li>
<li class='tocx'><a href='#9PbJaRizVB7'>5.7 定義リスト</a></li>
<li class='tocx'><a href='#cPmXTXvPhJd'>5.8 コメント</a></li>
<li class='tocx'><a href='#d2FXT7Fqg21'>5.9 強調</a></li>
<li class='tocx'><a href='#hBdBkqlaJVW'>5.10 取消し線</a></li>
<li class='tocx'><a href='#9k1sm8QrDHi'>5.11 マーカー</a></li>
<li class='tocx'><a href='#hVz7Qq0YetS'>5.12 上付きと下付き</a></li>
<li class='tocx'><a href='#fbLcMRTVXac'>5.13 リンク</a></li>
<li class='tocx'><a href='#2TegSYAerqJ'>5.14 コード</a></li>
<li class='tocx'><a href='#ba5hSrekAxp'>5.15 水平線</a></li>
<li class='tocx'><a href='#hpQu1WK1Nkr'>5.16 画像の挿入</a></li>
<li class='tocx'><a href='#akoPHkUM3jR'>5.17 改行の挿入</a></li>
<li class='tocx'><a href='#iwCMutWJWjc'>5.18 段落</a></li>
</blockquote>
</details>
<details class='tocx' open>
<summary class='tocx'><a href='#i9uAZw3xFSK'>6 拡張機能</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#kyMp8IkRK8n'>6.1 文書タイトルとスタイルシートの指定</a></li>
<li class='tocx'><a href='#bZZIHdLJ79G'>6.2 目次へのリンクボタン表示</a></li>
<li class='tocx'><a href='#gg7i7uPfLlo'>6.3 図と表のタイトル</a></li>
<li class='tocx'><a href='#4e8Wf4oSDqx'>6.4 アンカー</a></li>
<li class='tocx'><a href='#2Hh9eF0BTk3'>6.5 インラインスタイル指定</a></li>
<li class='tocx'><a href='#dOeJnU6OE95'>6.6 スタイルスタック</a></li>
<li class='tocx'><a href='#hVp0EDLBsmJ'>6.7 スタイルパレット</a></li>
<li class='tocx'><a href='#cjJv49XsD9d'>6.8 ページ内へのリンク</a></li>
<li class='tocx'><a href='#8mg4uLSAXaz'>6.9 キーワードへの自動リンク</a></li>
<li class='tocx'><a href='#6LkDjrI3ASb'>6.10 生の HTML の出力</a></li>
<li class='tocx'><a href='#9Dfk88hOKmk'>6.11 脚注</a></li>
<li class='tocx'><a href='#7maM1Z8DaEp'>6.12 目次の生成</a></li>
<li class='tocx'><a href='#iVFblGs7lu7'>6.13 図表一覧の生成</a></li>
<li class='tocx'><a href='#2C50p0Hw1s1'>6.14 索引の生成</a></li>
<li class='tocx'><a href='#f71ZNSHqufB'>6.15 フィルタ機能</a></li>
<li class='tocx'><a href='#18dTPnzNOgg'>6.16 外部フィルタの登録</a></li>
<li class='tocx'><a href='#fJ4r3VpDmqg'>6.17 テーブルの生成</a></li>
<li class='tocx'><a href='#hMHXjTrWEnw'>6.18 領域の折り畳み</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#a2FYBDWqZUA'>6.19 別ファイルの include</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#7dx1C8sPEB4'>6.19.1 起動オプションでの検索パス追加</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#hs1guSfsFGb'>6.20 改ページ指定</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#4eSrElLWBcH'>6.21 変数の定義と展開</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#2yDQLphjQX0'>6.21.1 データ内での設定と展開</a></li>
<li class='tocx'><a href='#kW5fA3S8XIj'>6.21.2 起動オプションでの変数設定</a></li>
<li class='tocx'><a href='#9Z7pya1EZOR'>6.21.3 システム変数</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#8sNFPrNb9kM'>6.22 条件分岐</a></li>
<li class='tocx'><a href='#anSuBAd7F3R'>6.23 マクロ関数</a></li>
<li class='tocx'><a href='#8d4GujOuk9v'>6.24 スニペット定義と展開</a></li>
<li class='tocx'><a href='#bs9N19eIT7w'>6.25 エラーと警告の出力</a></li>
</blockquote>
</details>
<details class='tocx' open>
<summary class='tocx'><a href='#cNngUDCfTMJ'>7 設定</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#0EKpSe2qrxR'>7.1 見出しにおける自動リンク</a></li>
<li class='tocx'><a href='#2M8QFQ2XeBn'>7.2 見出しの自動ナンバリング</a></li>
<li class='tocx'><a href='#hJJbL4GzVpQ'>7.3 図表のナンバリング単位</a></li>
<li class='tocx'><a href='#jkzhEyZU0ts'>7.4 スタイルシートの埋め込み</a></li>
<li class='tocx'><a href='#8a3vnTcmVrk'>7.5 コメントの出力</a></li>
</blockquote>
</details>
<details class='tocx' open>
<summary class='tocx'><a href='#4e69JBVCRLW'>8 細かい話</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#fSSOiFwQpEj'>8.1 入力ファイルのエンコーディングと改行スタイル</a></li>
<li class='tocx'><a href='#9s47bTtYstx'>8.2 文字装飾やリンクの制約と継続行</a></li>
<li class='tocx'><a href='#9IN7afRR0hr'>8.3 内部的な処理順序</a></li>
<li class='tocx'><a href='#6lxsyJvfG4q'>8.4 一部の文字装飾における制約</a></li>
<li class='tocx'><a href='#l3wNcsiymoY'>8.5 フィルタ機能について</a></li>
<li class='tocx'><a href='#8pNcG5W73uy'>8.6 領域の折り畳みについて</a></li>
<li class='tocx'><a href='#7l2ZW620d5G'>8.7 外部フィルタにおける一時ファイル名について</a></li>
<details class='tocx' open>
<summary class='tocx'><a href='#8qCsTwp3HZT'>8.8 作図まですべてテキストで実現する方法</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#bCCDfsVD85P'>8.8.1 PlantUML</a></li>
<li class='tocx'><a href='#8aJF91OqXMS'>8.8.2 gnuplot</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#62CICfavwWM'>8.9 画像ファイルを HTML 内に取り込む方法</a></li>
</blockquote>
</details>
<details class='tocx' open>
<summary class='tocx'><a href='#8tTIqHSNoTg'>9 既知の問題点</a></summary>
<blockquote class='tocx'>
<li class='tocx'><a href='#95miNJcW6DM'>9.1 【解決済】リンクテキストの末尾に文字装飾があると正しく処理されない</a></li>
<li class='tocx'><a href='#kjPiZRKvp7P'>9.2 【解決済】テーブルで colspan/rowspan を使うとアライメント指定がずれる</a></li>
<li class='tocx'><a href='#78o6GpB2DHz'>9.3 【解決済】条件分岐でファイル存在チェックをしても include がエラーになる</a></li>
<li class='tocx'><a href='#brtS2jyAYs6'>9.4 【解決済】C/C++ のコードハイライトで #if や #else が正しく処理されない</a></li>
<li class='tocx'><a href='#dguaQPYtqQN'>9.5 【解決済】リストの仕様が一般的な markdown と異なる</a></li>
</blockquote>
</details>
<li class='tocx'><a href='#dGdSPnvay5N'>10 更新履歴</a></li>
<li class='tocx'><a href='#1ewHzjI62xn'>11 索引</a></li>
<p>　　</p>
<h2><a name='ii4jRxV2ffy'></a>2 turnup とは</h2>
<p>　turnup は、<a class='term' href='#b3GXdVHw3CE'>Markdown</a> 書法で作成したテキストファイルから <a class='term' href='#ahN3t8jbawv'>HTML</a> を出力するツールです<sup><a name='footnote_ref1' href='#footnote1'>1</a></sup>。このマニュアル文書自体、turnup で作成されています。</p>
<p>　turnup の目的は、 <strong>「マニュアルや技術文書、設計文書などをテキストベースで作成・管理できるようにすること」</strong> です。git のようなバージョン管理システムが普及した現在でも、これらの文書作成にバイナリ形式のファイルを使用している限り、文書の管理には困難が伴います。手軽にテキストで文書作成ができるツールとして <a class='term' href='#b3GXdVHw3CE'>Markdown</a> 書法がありますが、<a class='term' href='#b3GXdVHw3CE'>Markdown</a> に対応した従来のツールは本家<sup><a name='footnote_ref2' href='#footnote2'>2</a></sup>を始めとして、全体的に機能不足でした。turnup はこの不足を埋めることを目的としているため、<a class='autolink' href='#9Dfk88hOKmk'>脚注</a>や<a href='#7maM1Z8DaEp'>目次</a>・<a href='#iVFblGs7lu7'>図表一覧</a>の生成、<a href='#2M8QFQ2XeBn'>見出しの自動ナンバリング</a>などの<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>を用意しています。</p>
<p>　turnup は、ワープロソフトそのものを置き換えようとしているわけではありません。最終的に印刷して頒布することが想定されるような文書では、ワープロソフトやもっと高品質な出力が可能な組版ソフトを使用した方が良いでしょう。</p>
<h2><a name='dcPEbaWhYMa'></a>3 用語</h2>
<dl>
<dt><a name='fgvQnqibuC4'></a>GFM</dt>
<dd>GitHub Flavored <a class='term' href='#b3GXdVHw3CE'>Markdown</a> というものの略語だそうです。turnup は可能な範囲でサポートするように心掛けています。</dd>
</dl>
<dl>
<dt><a name='b3GXdVHw3CE'></a>Markdown</dt>
<dd>マークダウンと読みます。</dd>
</dl>
<dl>
<dt><a name='ahN3t8jbawv'></a>HTML</dt>
<dd>Hyper text markup language の略語です。</dd>
</dl>
<dl>
<dt><a name='8sf6EgPf8j8'></a>空白類文字</dt>
<dd>スペース文字、タブ文字を意味します。いわゆる全角スペース文字も含みます。</dd>
</dl>
<h2><a name='h1vILBov6aJ'></a>4 使い方</h2>
<p>　入力となるファイルの名前をパラメータとして起動してください。生成された <a class='term' href='#ahN3t8jbawv'>HTML</a> は標準出力に書き出されるので、必要に応じてリダイレクトしてください。</p>
<pre>
  turnup  input.md  &gt;  output.html
</pre>
<p>　入出力ファイルのエンコーディングは utf-8 で固定となっています。それ以外のエンコーディングへの対応は現状では予定されていません。<a href='#4e69JBVCRLW'>細かい話</a>も参照してください。</p>
<h2><a name='8wGebtcPJwd'></a>5 記法</h2>
<p>　turnup の入力書式は一般的な <a class='term' href='#b3GXdVHw3CE'>Markdown</a> 書法と基本的に同じですが、いくつかの<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a><sup><a name='footnote_ref3' href='#footnote3'>3</a></sup>を備えています。</p>
<h3><a name='7HkxqP1TWY5'></a>5.1 見出し</h3>
<p>　行頭から１〜６個の # を記述し、続けて（半角）スペースをひとつ書いた行は<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>行になります。後続する文字列が<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>のタイトルとなります。# の数に応じて h1 〜 h6 になります。</p>
<pre>
 # header1
 ## header2
 ### header3
 #### header4
 ##### header5
 ###### header6
</pre>
<p>　<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>により、<a href='#2M8QFQ2XeBn'>見出しに番号を自動付与</a>したり、<a href='#7maM1Z8DaEp'>見出しから目次を生成</a>したりできます。</p>
<h3><a name='jGghWL1I5CM'></a>5.2 箇条書きリスト</h3>
<p>　-（ハイフン）、+（プラス）、または *（アスタリスク）にスペース（またはタブ）を後続させると、箇条書きリストになります。ネストさせたい場合は、行頭にタブ文字または（4文字までの）スペースを使用してください。</p>
<pre>
- List A
+ List B
    * List B - 1
    - List B - 2
        + List B - 2 - 1
        * List B - 2 - 2
    + List B - 3
- List C
</pre>
<p>　上記は、以下のように出力されます。</p>
<ul>
<li>List A</li>
<li>List B
<ul>
<li>List B - 1</li>
<li>List B - 2
<ul>
<li>List B - 2 - 1</li>
<li>List B - 2 - 2</li>
</ul>
</li>
<li>List B - 3</li>
</ul>
</li>
<li>List C</li>
</ul>
<h4><a name='5cVofWIxtWQ'></a>5.2.1 リスト要素における改行</h4>
<p>　一般的な markdown 書法同様、リストの要素は改行を利用して多くの情報をぶらさげることができます。（正直面倒なので）細かい説明は省略しますが、以下に例を示します。</p>
<pre>
-   blah blah 
    blah blah 
    blah blah 
- blah blah 
blah blah 

  next paragraph : blah blah 
blah blah blah blah blah

- list item with blockquote
    &gt; blah blah blah 
    &gt; blah blah blah 
    &gt; blah blah blah 
- list item with code
    - c code
        ```c
          int main( void ) {
              return 0;
          }
        ```
    - lisp code
        ```lisp
          (defun factorial (n)
            (labels ((impl (x acc)
                       (if (&lt;= x 1)
                           acc
                           (impl (1- x) (* acc x)))))
              (impl n 1)))
        ```
</pre>
<p>　上記は、以下のように出力されます。</p>
<ul>
<li><p>blah blah 
blah blah 
blah blah 
</p>
</li>
<li><p>blah blah 
blah blah 
</p>
<p>next paragraph : blah blah blah blah blah blah blah</p>
</li>
<li>list item with <a class='autolink' href='#2c4WKrG50Sg'>blockquote</a>
<blockquote>
<p>blah blah blah blah blah blah blah blah blah </p>
</blockquote>
</li>
<li>list item with code
<ul>
<li>c code
<pre class='code'>
  <span class='keyword2'>int</span> main( <span class='keyword2'>void</span> ) {
      <span class='keyword1'>return</span> 0;
  }
</pre>
</li>
<li>lisp code
<pre class='code'>
  (<span class='keyword1'>defun</span> <span class='keyword5'>factorial</span> (n)
    (<span class='keyword1'>labels</span> ((impl (x acc)
               (<span class='keyword1'>if</span> (&lt;= x 1)
                   acc
                   (impl (1- x) (* acc x)))))
      (impl n 1)))
</pre>
</li>
</ul>
</li>
</ul>
<h4><a name='04sRz8Off9s'></a>5.2.2 チェックボックス付きのリスト</h4>
<p>　また、- などの先頭記号とスペースに続けて [ ] や [X] を記述すると、チェックボックス付きリストになります。実際には X だけでなく、O や V、それらの小文字でも大丈夫です。</p>
<pre>
- Task list
    - [X] completed task
        * point 1
        * point 2
    - [ ] not completed task
</pre>
<p>　上記は、以下のように出力されます。</p>
<ul>
<li>Task list
<ul>
<li style='list-style-type:none;'><input type='checkbox' onclick='return false;' checked>completed task
<ul>
<li>point 1</li>
<li>point 2</li>
</ul>
</li>
<li style='list-style-type:none;'><input type='checkbox' onclick='return false;'>not completed task</li>
</ul>
</li>
</ul>
<p>　このチェックボックス付きリストについては１点だけ注意点があります。それはチェックボックスを使う場合、<a class='autolink' href='#dOeJnU6OE95'>スタイルスタック</a>が適用されなくなるということです。</p>
<h3><a name='iYSlVZhYmRM'></a>5.3 番号付きリスト</h3>
<p>　数字にピリオドとスペースを後続させると、番号付きリストになります。ネストさせたい場合は、行頭にタブ文字または（4文字までの）スペースを使用してください。</p>
<pre>
1. List A
1. List B
    1. List B - 1
    1. List B - 2
        1. List B - 2 - 1
1. List C
</pre>
<p>　上記は、以下のように出力されます。改行を使用してリスト要素に情報をぶらさげられるのは箇条書きリストと同様です。ただし、番号付きリストではチェックボックスの利用はできません。</p>
<ol>
<li>List A</li>
<li>List B
<ol>
<li>List B - 1</li>
<li>List B - 2
<ol>
<li>List B - 2 - 1</li>
</ol>
</li>
</ol>
</li>
<li>List C</li>
</ol>
<h3><a name='2HUs4TZfCPd'></a>5.4 preブロック</h3>
<p>　バッククォート3つ、またはチルダ3つだけからなる行で囲まれたブロックは <code>&lt;pre&gt;</code> ブロックとなります。<sup><a name='footnote_ref4' href='#footnote4'>4</a></sup></p>
<pre>
~~~
int main( void ) {
    std::cout &lt;&lt; "hello world." &lt;&lt; std::endl;
    return 0;
}
~~~
</pre>
<p>　上記は、以下のように出力されます。</p>
<pre>
int main( void ) {
    std::cout &lt;&lt; "hello world." &lt;&lt; std::endl;
    return 0;
}
</pre>
<p>　<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>として、<a class='autolink' href='#2HUs4TZfCPd'>preブロック</a>を開始する行に言語などの名前をつけることでコードハイライトをする機能もあります。これについての詳細は<a href='#f71ZNSHqufB'>6.15  フィルタ機能</a>を参照してください。</p>
<h3><a name='g6xjP526KX7'></a>5.5 テーブル</h3>
<p>　以下のような記述で<a class='autolink' href='#g6xjP526KX7'>テーブル</a>を作成できます。この場合、１行目は常にヘッダ行（th タグ）であり、２行目以降がデータ行（td タグ）になります。</p>
<pre>
| header A | header B | header C |	
|     0    |     1    |    2     |	
|     3    |     4    |    5     |	
|     6    |     7    |    8     |	
</pre>
<p>　上記は、以下のようになります。この場合、各列のデータはすべて左寄せになります。</p>
<table align='center'>
<tr><th>header A</th><th>header B</th><th>header C</th></tr>
<tr><td align='left'>0</td><td align='left'>1</td><td align='left'>2</td></tr>
<tr><td align='left'>3</td><td align='left'>4</td><td align='left'>5</td></tr>
<tr><td align='left'>6</td><td align='left'>7</td><td align='left'>8</td></tr>
</table>
<p>　列毎に中央揃え、右寄せなどのアライメント指定を指定をしたい場合には、２行目に :---: や ---: を記述します。</p>
<pre>
| header A | header B | header C |	
| :------- | :------: | -------: |	
|     0    |     1    |    2     |	
|     3    |     4    |    5     |	
|     6    |     7    |    8     |	
</pre>
<p>　上記は、以下のように出力されます（表はデフォルトでセンタリングされます）。</p>
<table align='center'>
<tr><th>header A</th><th>header B</th><th>header C</th></tr>
<tr><td align='left'>0</td><td align='center'>1</td><td align='right'>2</td></tr>
<tr><td align='left'>3</td><td align='center'>4</td><td align='right'>5</td></tr>
<tr><td align='left'>6</td><td align='center'>7</td><td align='right'>8</td></tr>
</table>
<p>　<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>として、２行目に記述する :---: や ---: では、- のかわりに = を使用することができます。 <code>:====:</code> などとした場合、その列は nowrap 指定が追加され、<strong>「自動的な折り返しを禁止」</strong> することができます<sup><a name='footnote_ref5' href='#footnote5'>5</a></sup>。</p>
<p>　さらに、:---: や ---: の行は２行目よりも後ろに書くことができます。それにより、複数行に渡るヘッダ行を記述することができます。以下のように。</p>
<pre>
|     A    |     B    |    C     |	
|   Alpha  |   Bravo  |  Charlie |	
| :------- | :------: | -------: |	
|     0    |     1    |    2     |	
|     3    |     4    |    5     |	
|     6    |     7    |    8     |	
</pre>
<p>　上記は、以下のように出力されます。</p>
<table align='center'>
<tr><th>A</th><th>B</th><th>C</th></tr>
<tr><th>Alpha</th><th>Bravo</th><th>Charlie</th></tr>
<tr><td align='left'>0</td><td align='center'>1</td><td align='right'>2</td></tr>
<tr><td align='left'>3</td><td align='center'>4</td><td align='right'>5</td></tr>
<tr><td align='left'>6</td><td align='center'>7</td><td align='right'>8</td></tr>
</table>
<p>　別の拡張として、セル結合がサポートされています。セルを開始する | の直後に N&gt; （ここで N は数値）を指定することで、セルを横方向に N 列結合させることができます。同様に、N^ とすることでセルを縦方向に N 列結合させることができます<sup><a name='footnote_ref6' href='#footnote6'>6</a></sup>。以下に例を示します。</p>
<pre>
|2&gt;      A &amp; B        |2^ C&lt;br&gt;Charlie |	
|   Alpha  |   Bravo  |
| :------- | :------: | -------: |	
|     0    |     1    |    2     |	
|     3    |     4    |    5     |	
|     6    |     7    |    8     |	
</pre>
<p>　上記は、以下のように出力されます。</p>
<table align='center'>
<tr><th colspan='2'>A &amp; B</th><th rowspan='2'>C<br>Charlie</th></tr>
<tr><th>Alpha</th><th>Bravo</th></tr>
<tr><td align='left'>0</td><td align='center'>1</td><td align='right'>2</td></tr>
<tr><td align='left'>3</td><td align='center'>4</td><td align='right'>5</td></tr>
<tr><td align='left'>6</td><td align='center'>7</td><td align='right'>8</td></tr>
</table>
<p>　　</p>
<p>　アライメント指定行は複数記述できるようになりました。最初のアライメント指定行がヘッダとデータの境界となるのは従来通りで、アライメント指定は次のアライメント指定行が登場するまでの間有効となります。これにより、<a href='#kjPiZRKvp7P'>セル結合とアライメント指定を併用した場合の問題</a>に対処することができます。以下に例を示します。</p>
<pre>
| column A | column B | column C |
|:---------|:--------:|---------:|
|left      |center    |right     |
|:--------------------|---------:|
|2&gt; left              |right?    |
|:---------|:--------:|---------:|
|left      |center    |right     |
</pre>
<p>　上記は、以下のようになります。</p>
<table align='center'>
<tr><th>column A</th><th>column B</th><th>column C</th></tr>
<tr><td align='left'>left</td><td align='center'>center</td><td align='right'>right</td></tr>
<tr><td align='left' colspan='2'>left</td><td align='right'>right?</td></tr>
<tr><td align='left'>left</td><td align='center'>center</td><td align='right'>right</td></tr>
</table>
<p>　　 </p>
<p>　version 0.815 より、内部フィルタを使って CSV 形式などのデータから<a class='autolink' href='#g6xjP526KX7'>テーブル</a>を生成できるようになりました。この<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>については「<a href='#fJ4r3VpDmqg'>6.17  テーブルの生成</a>」を参照してください。</p>
<h3><a name='2c4WKrG50Sg'></a>5.6 引用</h3>
<p>　&gt; で始まる行は<a class='autolink' href='#2c4WKrG50Sg'>引用</a>になります。連続する<a class='autolink' href='#2c4WKrG50Sg'>引用</a>のブロックは <code>&lt;blockquote&gt;</code> タグで括られ、通常の各種書法に従って処理されます。これはネストさせることができます。</p>
<pre>
&gt;  blah blah blah blah blah blah 
&gt; blah blah blah blah blah blah 
&gt;
&gt; * foo
&gt;     * bar
&gt;     * quux
&gt;
&gt;&gt; blah blah blah blah blah blah 
&gt;&gt; blah blah blah blah blah blah 
&gt;
&gt; block-quoted code
&gt;
&gt; ```C++
&gt;   int main( void ){
&gt;       std::cout &lt;&lt; "hello world." &lt;&lt; std::endl;
&gt;       return 0;
&gt;   }
&gt; ```
&gt;
</pre>
<p>　上記は、以下のように出力されます。</p>
<blockquote>
<p> blah blah blah blah blah blah blah blah blah blah blah blah </p>
<ul>
<li>foo
<ul>
<li>bar</li>
<li>quux</li>
</ul>
</li>
</ul>
<blockquote>
<p>blah blah blah blah blah blah blah blah blah blah blah blah </p>
</blockquote>
<p>block-quoted code</p>
<pre class='code'>
  <span class='keyword2'>int</span> main( <span class='keyword2'>void</span> ){
      std::cout &lt;&lt; <span class='literal'>"hello world."</span> &lt;&lt; std::endl;
      <span class='keyword1'>return</span> 0;
  }
</pre>
</blockquote>
<h3><a name='9PbJaRizVB7'></a>5.7 定義リスト</h3>
<p>　以下のような記述により、<a class='autolink' href='#9PbJaRizVB7'>定義リスト</a>を作成できます。turnup では、これによって定義された用語は<a href='#8mg4uLSAXaz'>自動リンク</a>の対象となります。</p>
<pre>
  *[用語]: 用語の定義をここに記述します。
  複数行に渡る定義も記述できます。空行で終わります。

</pre>
<p>　上記は、以下のように出力されます。</p>
<dl>
  <dt>用語</dt>
  <dd>用語の定義をここに記述します。複数行に渡る定義も記述できます。空行で終わります。</dd>
</dl>
<p>　[ と ] に囲まれた用語は、前後のスペースは無視されますが、途中にあるスペースは用語の一部とみなされます。</p>
<h3><a name='cPmXTXvPhJd'></a>5.8 コメント</h3>
<p>　turnup は、以下のような <a class='term' href='#ahN3t8jbawv'>HTML</a> 形式の<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>を<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>として扱います。つまり、出力される <a class='term' href='#ahN3t8jbawv'>HTML</a> の内容には含まれません。</p>
<pre>
  &lt;!-- comment --&gt;

  &lt;!--
    multi
    line
    comment
  --&gt;
</pre>
<p>　ただし、この挙動は変更することができます。<a href='#8a3vnTcmVrk'>write-comment設定</a>を参照してください。</p>
<h3><a name='d2FXT7Fqg21'></a>5.9 強調</h3>
<p>　1 〜 3 個の連続するアスタリスクまたはアンダースコアで括ることにより、文字列を強調することができます。どのように表示されるのかは、スタイルシート次第です。</p>
<ul>
<li>１つだと、em タグによる強調になります。 <code>*これ*</code> が、 <em>これ</em> になります。</li>
<li>２つだと、strong タグによる強調になります。 <code>**これ**</code> が、 <strong>これ</strong> になります。</li>
<li>３つだと、em と strong の併用になります。 <code>***これ***</code> が、 <em><strong>これ</strong></em> になります。</li>
</ul>
<p>　この書法が適用されるルールには、少し細かい規則があります。<a href='#6lxsyJvfG4q'>8.4  一部の文字装飾における制約</a>を参照してください。</p>
<h3><a name='hBdBkqlaJVW'></a>5.10 取消し線</h3>
<p>　２つのチルダ ~~ で括ることで、文字列に取消線を引くことができます。<code>~~この部分は取消し~~</code> が、 <strike>この部分は取消し</strike> になります。</p>
<p>　この書法が適用されるルールには、少し細かい規則があります。<a href='#6lxsyJvfG4q'>8.4  一部の文字装飾における制約</a>を参照してください。</p>
<h3><a name='9k1sm8QrDHi'></a>5.11 マーカー</h3>
<p>　== を使って括ることで、マーカーを利用することができます。スタイルシート次第ですが、 <code>==例えばこんなふう==</code> が、 <mark>例えばこんなふう</mark> になります。</p>
<p>　この書法が適用されるルールには、少し細かい規則があります。<a href='#6lxsyJvfG4q'>8.4  一部の文字装飾における制約</a>を参照してください。</p>
<h3><a name='hVz7Qq0YetS'></a>5.12 上付きと下付き</h3>
<p>　単一の ^ および ~ で括ると、文字列を上付きと下付きにできます。たとえば <code>H~2~O</code> は H<sub>2</sub>O に、 <code>2^10^ = 1024</code> は 2<sup>10</sup> = 1024 になります。</p>
<h3><a name='fbLcMRTVXac'></a>5.13 リンク</h3>
<p>　文章中で以下のような書き方をすることで、URL へのリンクを貼ることができます。<sup><a name='footnote_ref7' href='#footnote7'>7</a></sup></p>
<pre>
  [テキスト](URL)
</pre>
<p>　たとえば、 <code>[Google](https://www.google.co.jp/)</code> は <a href='https://www.google.co.jp/'>Google</a> となります。テキスト部分を省略すると、URL がそのまま表示されます。つまり、<code>[](https://www.google.co.jp/)</code> は <a href='https://www.google.co.jp/'>https://www.google.co.jp/</a> となります。</p>
<p>　<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>として、ページ内の<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>や図表タイトルへのリンクを作成することもできます。<a href='#cjJv49XsD9d'>6.8  節</a>を参照してください。</p>
<h3><a name='2TegSYAerqJ'></a>5.14 コード</h3>
<p>　文章中では、以下のようにバッククォートで括ることで、囲まれた部分をコードとして表示させられます。この内部にある文字列は、<a href='#8mg4uLSAXaz'>自動リンク</a>やその他の文字装飾は実行されません。</p>
<pre>
  `code`
</pre>
<p>　この書法が適用されるルールには、少し細かい規則があります。<a href='#6lxsyJvfG4q'>8.4  一部の文字装飾における制約</a>を参照してください。</p>
<h3><a name='ba5hSrekAxp'></a>5.15 水平線</h3>
<p>　行頭からハイフン、等号、アンダースコア、アスタリスクを３個以上を記述すると水平線として出力されます。文字種は混在させないでください。</p>
<h3><a name='hpQu1WK1Nkr'></a>5.16 画像の挿入</h3>
<p>　画像を表示させるには、以下のように記述します。独立した行として記述することもできますし、文章中にインラインで挿入させることもできます。</p>
<pre>
  ![代替テキスト](画像URL)
</pre>
<p>　上記は、以下のように展開されます。なお、代替テキストは省略できます。</p>
<pre>
  &lt;img src='画像URL' alt='代替テキスト' /&gt;
</pre>
<h3><a name='akoPHkUM3jR'></a>5.17 改行の挿入</h3>
<p>　文中で改行させるには、<a class='term' href='#ahN3t8jbawv'>HTML</a> タグ <code>&lt;br&gt;</code> をそのまま書きます。</p>
<h3><a name='iwCMutWJWjc'></a>5.18 段落</h3>
<p>　<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>を含め、他の書法と認識されない行はすべて段落の開始とみなされます。段落は空行または<a href='#cPmXTXvPhJd'>コメント</a>行に至るまでのすべての行が連結され、単一の段落として出力されます。</p>
<p>　　</p>
<h2><a name='i9uAZw3xFSK'></a>6 拡張機能</h2>
<p>　turnup には、いくつかの<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>があります。一般的な <a class='term' href='#b3GXdVHw3CE'>Markdown</a> の書法からは逸脱しますが、文書作成に必要と判断して追加しているものです。</p>
<h3><a name='kyMp8IkRK8n'></a>6.1 文書タイトルとスタイルシートの指定</h3>
<p>　データファイルの冒頭に以下のような<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>を記述することで、出力される <a class='term' href='#ahN3t8jbawv'>HTML</a> ファイルのヘッダに設定するタイトルとスタイルシートを指定することができます。</p>
<pre>
  &lt;!-- title:Document title --&gt;
  &lt;!-- style:./default.css --&gt;
</pre>
<p>　このうち、スタイルシートの指定は設定の影響を受けます。詳細は<a href='#jkzhEyZU0ts'>embed-stylesheet設定</a>を参照してください。</p>
<h3><a name='bZZIHdLJ79G'></a>6.2 目次へのリンクボタン表示</h3>
<p>　以下のような行をデータファイル内の任意の場所に記述しておくと、</p>
<pre>
  &lt;!-- toc-link: top "Table of contents" --&gt;
</pre>
<p>　生成された <a class='term' href='#ahN3t8jbawv'>HTML</a> ページの右上に以下のようなイメージが表示されます。これは画面をスクロールしてもその位置に留まり、クリックすると目次にジャンプすることができます。</p>
<div align="center"><a href='#0qJQvVjc3Xy'>
<svg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox="0 0 200 200">
<defs><g id="line">
  <circle cx='45' cy='50' r='15' fill='white' stroke='none' stroke-width='1' />
  <polyline fill='none' stroke='white' stroke-width='20' points=' 75.0,50.0 170.0,50.0' />
</g></defs>
<rect x='0' y='0' width='200' height='200' rx='30' ry='30' fill='lightgray' stroke='none' stroke-width='1' />
<use xlink:href="#line" x='0' y='0' />
<use xlink:href="#line" x='0' y='50' />
<use xlink:href="#line" x='0' y='100' />
</svg>
</a></div>
<p>　これは、実際には目次にジャンプしているわけではなく、指定された<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>へのリンクに過ぎません。そのため、この機能を使用する場合は目次の直前に<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>を置く必要があります。ジャンプ先の<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>は <code>toc-link: top</code> に続けて指定してください（先の例であれば <code>"Table of contents"</code> という部分）。この機能を使用する場合、目次の周辺は以下のように記述されることになるでしょう。</p>
<pre>
​## Table of contents

&lt;​!-- embed:toc-x 2 4 --&gt;
&lt;​!-- toc-link: top 'Table of contents' --&gt;
</pre>
<p>　なお、以下のように <code>toc-link:</code> に続けて <code>top</code> でなく <code>bottom</code> と記述すると、イメージの表示される位置が画面の右上でなく右下になります。</p>
<pre>
  &lt;!-- toc-link: bottom "Table of contents" --&gt;
</pre>
<h3><a name='gg7i7uPfLlo'></a>6.3 図と表のタイトル</h3>
<p>　図と表には、専用のタイトルをつけることができます。図（大抵は画像を表示させるという意味ですが）の場合、以下のように行頭に <code>Figure.</code> を、それに続いてタイトルを書きます。</p>
<pre>
![](some-figure.png)
Figure. title of figure
</pre>
<p>　表の場合は行頭に <code>Table.</code> を、それに続いてタイトルを書きます。</p>
<pre>
Table. title of table
| header1 | header2 |
| :------ | :-----: |
|    0    |    1    |
|    2    |    3    |
</pre>
<p>　この方法でタイトルをつけておけば、同じく<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>の<a href='#iVFblGs7lu7'>図表一覧の生成</a>機能で一覧を生成することができます。</p>
<p>　<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>と同様に、図表のタイトルには自動的に番号付けを行なうことができます。詳細は「<a href='#hJJbL4GzVpQ'>7.3  図表のナンバリング単位</a>」を参照してください。</p>
<h3><a name='4e8Wf4oSDqx'></a>6.4 アンカー</h3>
<p>　以下の形式の<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>を記述することにより、リンク先となる<a class='autolink' href='#4e8Wf4oSDqx'>アンカー</a>を任意の場所に作成できます。</p>
<pre>
&lt;​!-- anchor: ANCHORNAME --&gt;
</pre>
<p>　この方法で作成した<a class='autolink' href='#4e8Wf4oSDqx'>アンカー</a>へのリンクを作成する場合、<a href='#cjJv49XsD9d'>ページ内へのリンク</a>に記載した方法に従って、 <code>[LABEL](A#ANCHORNAME)</code> 形式のページ内リンクを記述してください。</p>
<h3><a name='2Hh9eF0BTk3'></a>6.5 インラインスタイル指定</h3>
<p>　文章中などで部分的に文字色やその他のスタイルを指定したい場合、<a class='autolink' href='#2Hh9eF0BTk3'>インラインスタイル指定</a>が使用できます。以下のいずれかの書法<sup><a name='footnote_ref8' href='#footnote8'>8</a></sup>で、 <code>STYLES</code> 部分には <a class='term' href='#ahN3t8jbawv'>HTML</a> の style に指定する内容をそのまま記述します。</p>
<pre>
 @{{STYLES}{CONTENTS}}
 @((STYLES)(CONTENTS))
</pre>
<p>　上記は、 <code>&lt;span style='STYLES'&gt;CONTENTS&lt;/span&gt;</code> のように展開されます。たとえば、<code>@((background:red; color:white;)(赤地の白抜き))</code> が<span style='background:red; color:white;'>赤地の白抜き</span>になります。</p>
<p>　範囲指定でタグ別にスタイルを指定したい場合、次に説明する「<a class='autolink' href='#dOeJnU6OE95'>スタイルスタック</a>」を利用してください。</p>
<h3><a name='dOeJnU6OE95'></a>6.6 スタイルスタック</h3>
<p>　<a class='autolink' href='#2Hh9eF0BTk3'>インラインスタイル指定</a>は文章の一部分にスタイルを指定するものでしたが、もっと広い範囲でスタイルを一時的に変更したい場合もあります。そのような場合には、 <strong>「<a class='autolink' href='#dOeJnU6OE95'>スタイルスタック</a>」</strong> が使用できます。これは、以下の要領で <a class='term' href='#ahN3t8jbawv'>HTML</a> タグと区間を指定し、class や style を設定するものです。</p>
<pre>
 &lt;!-- stack:push p style="color: red;" --&gt;
        :
        :
 &lt;!-- stack:pop p --&gt;
</pre>
<p>　上記の例では、 <code>stack:push</code> として p タグに style を設定しています。この行以降、<code>stack:pop p</code> されるまでの間に turnup が生成する全ての p タグには、 <code>style="color: red;"</code>が設定されるようになります。</p>
<p>　名前の通り、この設定はスタックのように振舞います。 <code>stack:push</code> で指定する各種のタグそれぞれについて、最後に <code>stack:push</code> した内容が有効であり、 <code>stack:pop</code> すると設定前の状態に戻ります。以下に例を示します。</p>
<pre>
 ここは範囲外です。
 &lt;!-- stack:push p style="color: red;" --&gt;
 ここは赤字になるはず。
 &lt;!-- stack:push p style="background: blue; color: white;" --&gt;
 ここは青地に白い字になるはず。
 &lt;!-- stack:pop p --&gt;
 ここは赤字のはず。
 &lt;!-- stack:pop p --&gt;
 ここも範囲外です。
</pre>
<details>
<summary>◆結果はこちら。</summary>
<p>ここは範囲外です。</p>
<p style="color: red;">ここは赤字になるはず。</p>
<p style="background: blue; color: white;">ここは青地に白い字になるはず。</p>
<p style="color: red;">ここは赤字のはず。</p>
<p>ここも範囲外です。</p>
</details>
<p>　<a class='autolink' href='#dOeJnU6OE95'>スタイルスタック</a>の効果は、<a class='autolink' href='#f71ZNSHqufB'>フィルタ機能</a>が生成する出力には及びません。また、その他にも<a class='autolink' href='#dOeJnU6OE95'>スタイルスタック</a>が影響しないタグが存在します。</p>
<h3><a name='hVp0EDLBsmJ'></a>6.7 スタイルパレット</h3>
<p>　<a class='autolink' href='#dOeJnU6OE95'>スタイルスタック</a>は便利なものですが、<a class='autolink' href='#g6xjP526KX7'>テーブル</a>の特定の行やセルにスタイルを設定したい場合には役に立ちません。そのような場合には、 <strong>「<a class='autolink' href='#hVp0EDLBsmJ'>スタイルパレット</a>」</strong> が使用できます。これは、以下の要領でスタイルに番号付けをして登録できるものです。</p>
<pre>
 &lt;!-- palette: 0 style="background: #f4f4f4;" --&gt;
 &lt;!-- palette: 1 style="color: red;" --&gt;
</pre>
<p>　<code>&lt;!-- palette:</code>  に続く数字がインデックスで、これには 0 〜 9 までの 10種類が使用できます。それに続けてスタイルなど任意の <a class='term' href='#ahN3t8jbawv'>HTML</a> 属性を記述し、最後に <code>--&gt;</code> で終了します。</p>
<p>　パレットに登録したスタイルを使うには、インデックスを指定します。現状では<a class='autolink' href='#g6xjP526KX7'>テーブル</a>しか<a class='autolink' href='#hVp0EDLBsmJ'>スタイルパレット</a>に対応していない<sup><a name='footnote_ref9' href='#footnote9'>9</a></sup>ため、ここでは<a class='autolink' href='#g6xjP526KX7'>テーブル</a>での利用方法を説明します。以下に例を示します。</p>
<pre>
  | title | count | price | 
  |:------|------:|------:|
  | foo   |     1 |   666 |
[0| bar   |     2 |1] -99 |
  | baz   |     3 |1]  -8 |
[0| quux  |     4 |   123 |
</pre>
<ul>
<li>行全体にスタイルを適用したい場合、行頭の | の手前に <code>[N</code> を記述</li>
<li>セル単独でスタイルを適用したい場合は、セルを開始する | に続けて <code>N]</code> を記述</li>
</ul>
<p>　上記において、N は適用したいスタイルを登録したパレットのインデックスです。実際に使ってみると、以下のように表示されます。</p>
<table align='center'>
<tr><th>title</th><th>count</th><th>price</th></tr>
<tr><td align='left'>foo</td><td align='right'>1</td><td align='right'>666</td></tr>
<tr style="background: #f4f4f4;"><td align='left'>bar</td><td align='right'>2</td><td style="color: red;" align='right'>-99</td></tr>
<tr><td align='left'>baz</td><td align='right'>3</td><td style="color: red;" align='right'>-8</td></tr>
<tr style="background: #f4f4f4;"><td align='left'>quux</td><td align='right'>4</td><td align='right'>123</td></tr>
</table>
<h3><a name='cjJv49XsD9d'></a>6.8 ページ内へのリンク</h3>
<p>　リンクの書法を拡張することで、ページ内の<a href='#7HkxqP1TWY5'>見出し</a>や<a href='#gg7i7uPfLlo'>図表タイトル</a>、<a class='autolink' href='#4e8Wf4oSDqx'>アンカー</a>へのリンクを作成することができます。</p>
<p>　ページ内の<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>へのリンクを作成する場合、URL 部分を # に続けて<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>の名前にしてください。たとえば、 <code>[目次](#Table of contents)</code> は<a href='#0qJQvVjc3Xy'>目次</a>となります。テキスト部分を省略した場合のルールは標準的な URL リンクと同じですが、<a href='#2M8QFQ2XeBn'>見出しの自動ナンバリング</a>を設定している場合、番号付けされた<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>名がリンクのテキストとなることに注意してください。つまり、 <code>[](#Table of contents)</code> は<a href='#0qJQvVjc3Xy'>1  Table of contents</a>となります。</p>
<p>　<a href='#gg7i7uPfLlo'>図表タイトル</a>へのリンクを作成するには、（ちょっと無様ですが）以下のように F#, T# に続けてタイトルを記述します。それ以外のルールは<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>へのリンクと同じです。</p>
<pre>
  [テキスト](F#図のタイトル)
  [テキスト](T#表のタイトル)
</pre>
<p>　<a class='autolink' href='#4e8Wf4oSDqx'>アンカー</a>へのリンクを作成するには、（これも無様ですが）以下のように A# に続けてタイトルを記述します。それ以外のルールは<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>へのリンクと同じです。</p>
<pre>
  [テキスト](A#アンカーのタイトル)
</pre>
<p>　さらに、テキスト部分では <code>$@</code> と <code>$$</code> を使うことができます。これらは、以下のように展開されます。</p>
<ul>
<li><code>$@</code> : 自動ナンバリングによって付与されるプレフィクス</li>
<li><code>$$</code> : <a class='autolink' href='#7HkxqP1TWY5'>見出し</a>や図表タイトルの文字列</li>
</ul>
<p>　ただし、<a class='autolink' href='#4e8Wf4oSDqx'>アンカー</a>や自動ナンバリングの対象となっていない<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>レベルへのリンクでは <code>$@</code> は空文字列に展開されるので注意してください。</p>
<h3><a name='8mg4uLSAXaz'></a>6.9 キーワードへの自動リンク</h3>
<p>　以下のような<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>記述により、キーワードへの自動リンクを設定することができます。</p>
<pre>
  &lt;!-- autolink: [TITLE](URL) --&gt;
</pre>
<p>　上記において、 <code>[TITLE](URL)</code> という部分は<a href='#fbLcMRTVXac'>リンク</a>および<a href='#cjJv49XsD9d'>ページ内へのリンク</a>の書法に従います。これによって、 <code>TITLE</code> という文字列が登場すると、自動的に <code>URL</code> へのリンクが作成されます。これは、上記<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>記述をした位置に関係なく、 <strong>文書全体において</strong> 適用されます<sup><a name='footnote_ref10' href='#footnote10'>10</a></sup>。</p>
<p>　この <a class='autolink' href='#8mg4uLSAXaz'>autolink</a> <a class='autolink' href='#cPmXTXvPhJd'>コメント</a>に記載するリンクは、通常のリンクとは異なり、 <code>TITLE</code> を空文字列にすることはできません。<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>や図表のタイトルの文字列をそのまま使用したい場合は <code>$$</code> を使用してください。</p>
<p>　<a href='#9PbJaRizVB7'>定義リスト</a>を使った用語定義も、同様に自動リンクになります。この場合、自動リンクのリンク先は定義箇所になります。このマニュアル文書では、「<a href='#dcPEbaWhYMa'>3  用語</a>」というセクションで（サンプルを兼ねて）いくつかの用語を定義しているので、たとえば <a class='term' href='#b3GXdVHw3CE'>Markdown</a> という用語は自動的にリンクされます。</p>
<p>　<code>autolink</code> <a class='autolink' href='#cPmXTXvPhJd'>コメント</a>による自動リンクと<a class='autolink' href='#9PbJaRizVB7'>定義リスト</a>は、定義の仕方は異なりますが同様に適用されるため、同じキーワードや用語を重複させることはできません（エラーになります<sup><a name='footnote_ref11' href='#footnote11'>11</a></sup>）。また、この<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>に関与する設定として、<a href='#0EKpSe2qrxR'>見出しにおける自動リンク</a>があります。</p>
<h3><a name='6LkDjrI3ASb'></a>6.10 生の HTML の出力</h3>
<p>　以下のように記述することで、生の <a class='term' href='#ahN3t8jbawv'>HTML</a> をそのまま出力することができます。</p>
<pre>
```raw
    :
    :
```
</pre>
<p>　これは、後述する<a class='autolink' href='#f71ZNSHqufB'>フィルタ機能</a>を利用しています。以前のバージョンでは以下のように <code>&lt;raw_html&gt;</code> タグで囲むことになっていましたが、これは非推奨となりました。まだ使用することはできますが、警告が表示されます。</p>
<pre>
  &lt;raw_html&gt;
      :
      :
  &lt;/raw_html&gt;
</pre>
<h3><a name='9Dfk88hOKmk'></a>6.11 脚注</h3>
<p>　文章中に<a class='autolink' href='#9Dfk88hOKmk'>脚注</a>を設定し、一箇所にまとめて表示させることができます。開始を示す <code>{{fn:</code> と終了を示す <code>}}</code> は同一の行に記述する必要があることに注意してください。</p>
<pre>
  {{fn:これが脚注の内容です。}}
</pre>
<p>　<a class='autolink' href='#9Dfk88hOKmk'>脚注</a>をまとめて表示するには、<a class='autolink' href='#9Dfk88hOKmk'>脚注</a>を展開したい場所（通常は登場文書の末尾でしょう）に以下の行を記述します。これにより、その場所に文書内のすべての<a class='autolink' href='#9Dfk88hOKmk'>脚注</a>が記載順で一覧されます。</p>
<pre>
  &lt;!-- embed:footnotes --&gt;
</pre>
<p>　このマニュアル文書でも、いくつかの<a class='autolink' href='#9Dfk88hOKmk'>脚注</a>を（サンプルを兼ねて）使用しています。文書末尾を参照してください。</p>
<h3><a name='7maM1Z8DaEp'></a>6.12 目次の生成</h3>
<p>　<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>情報から目次を生成することができます。以下のように記述すると、その場所に階層化されたリストの形式で目次が作成されます。</p>
<pre>
  &lt;!-- embed:toc --&gt;
</pre>
<p>　上記の指定では、<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>レベルの１から６までが全て目次化の対象になります。この対象範囲を絞るには、以下のように記述します。</p>
<pre>
  &lt;!-- embed:toc 2 4 --&gt;
</pre>
<p>　この例では、<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>レベル２〜４までが目次化の対象となります。</p>
<p>　<code>embed:toc</code> のかわりに <code>embed:toc-x</code> を使うことで、折り畳み可能な目次を生成できます。このマニュアルの<a href='#0qJQvVjc3Xy'>冒頭にある目次</a>も <code>toc-x</code> を使用して生成されています。</p>
<h3><a name='iVFblGs7lu7'></a>6.13 図表一覧の生成</h3>
<p>　目次と同様、図と表の一覧を生成することができます。以下のように記述すると、その場所に図の一覧が作成されます。</p>
<pre>
  &lt;!-- embed:figure-list --&gt;
</pre>
<p>　表の一覧の場合は以下です。</p>
<pre>
  &lt;!-- embed:table-list --&gt;
</pre>
<p>　これによって生成される一覧でも、<a href='#gg7i7uPfLlo'>図表タイトル</a>と同じ設定でナンバリングが行なわれます。詳細は「<a href='#hJJbL4GzVpQ'>7.3  図表のナンバリング単位</a>」を参照してください。</p>
<h3><a name='2C50p0Hw1s1'></a>6.14 索引の生成</h3>
<p>　<a class='autolink' href='#9PbJaRizVB7'>定義リスト</a>、およびキーワードへの自動リンクの定義から索引を自動生成することができます。以下の記述により、その場所に索引が生成されます。</p>
<pre>
  &lt;!-- embed:index --&gt;
</pre>
<p>　<code>embed:index</code> のかわりに <code>embed:index-x</code> を使うことで、折り畳み可能な索引を生成できます。このマニュアルの<a href='#1ewHzjI62xn'>末尾にある索引</a>も <code>index-x</code> を使用して生成されています。</p>
<h3><a name='f71ZNSHqufB'></a>6.15 フィルタ機能</h3>
<p>　<a class='autolink' href='#2HUs4TZfCPd'>preブロック</a>を開始する行に言語などの名前をつけることでコードハイライトをすることができます。これは turnup では <strong><a class='autolink' href='#f71ZNSHqufB'>フィルタ機能</a></strong> と呼ばれ、コードハイライトに限らずブロックの中身に様々な変換をかける仕組みとして位置付けられています。たとえば、diff の出力に色付けをしたければ以下のように記述します。</p>
<pre>
~~~diff
diff --git a/main.cxx b/main.cxx
index 16fc9f4..8387187 100644
--- a/main.cxx
+++ b/main.cxx
@@ -3,5 +3,5 @@ int main( void ) {
 
-    printf( "hello world.\n" );
+    std::cout &lt;&lt; "hello world." &lt;&lt; std::endl;

    return 0;
~~~
</pre>
<p>　これは以下のように表示されます。</p>
<pre class='diff'>
diff --git a/main.cxx b/main.cxx
index 16fc9f4..8387187 100644
<span class='diff_head'>--- a/main.cxx</span>
<span class='diff_head'>+++ b/main.cxx</span>
<span class='diff_line'>@@ -3,5 +3,5 @@ int main( void ) {</span>
 
<span class='diff_del'>-    printf( "hello world.\n" );</span>
<span class='diff_add'>+    std::cout &lt;&lt; "hello world." &lt;&lt; std::endl;</span>

    return 0;
</pre>
<p>　現在、turnup が提供しているフィルタは以下の通りです。つまり、 <strong>まだちょっとしか実装されていません</strong><sup><a name='footnote_ref12' href='#footnote12'>12</a></sup>。</p>
<ul>
<li>C</li>
<li>C++</li>
<li>diff</li>
<li>sh</li>
<li>Common LISP</li>
<li><a class='autolink' href='#6LkDjrI3ASb'>raw</a> （これは<a href='#6LkDjrI3ASb'>生の HTML を出力</a>するためのものです）</li>
<li><a class='autolink' href='#fJ4r3VpDmqg'>table</a> （これは<a href='#fJ4r3VpDmqg'>テーブルの作成を支援</a>するためのものです）</li>
</ul>
<p>　しかし、<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>として外部プログラムを用いたフィルタリングが可能となっています。詳しくは、<a href='#18dTPnzNOgg'>6.16  外部フィルタの登録</a>を参照してください。また内蔵の<a class='autolink' href='#f71ZNSHqufB'>フィルタ機能</a>によるコードハイライトについては<a href='#4e69JBVCRLW'>細かい話</a>があります。</p>
<h3><a name='18dTPnzNOgg'></a>6.16 外部フィルタの登録</h3>
<p>　<a class='autolink' href='#2HUs4TZfCPd'>preブロック</a>で指定するフィルタとして、外部プログラムを追加することができます。たとえば、foo というフィルタを指定した場合に quux プログラムを通した結果を表示させたければ以下のように指定します。</p>
<pre>
  &lt;!-- filter:foo = quux %in %out --&gt;
</pre>
<p>　ここで <code>&lt;!-- filter:</code> の直後から <code>=</code> まで（ここでは <code>foo</code> ）がフィルタ名、 <code>=</code> から 最後の <code>--&gt;</code> の手前まで（ここでは <code>quux %in %out</code> ）が実行するフィルタプログラムです。%in と %out は入力ファイル名と出力ファイル名のプレースホルダで、実際に使用されるファイル名は turnup が都度決定します。</p>
<p>　上記のように定義されていると、turnup はフィルタ名として foo が指定された <a class='autolink' href='#2HUs4TZfCPd'>preブロック</a>を見つけた場合に、以下の要領で処理を行ないます。</p>
<ul>
<li>pre ブロックの中身を一時ファイルに保存する</li>
<li>フィルタプログラムの定義に従い、 <code>quux %in %out</code> を実行する
<ul>
<li>この時、<a class='autolink' href='#2HUs4TZfCPd'>preブロック</a>の中身を保存した一時ファイル名で %in を置き換える</li>
<li>同様に、%out を別の一時ファイル名で置き換える</li>
</ul>
</li>
<li>%out に指定した一時ファイルの内容を読み込み、<a class='autolink' href='#2HUs4TZfCPd'>preブロック</a>のフィルタ結果として出力する</li>
</ul>
<p>　<a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a>は turnup が提供する<a class='autolink' href='#f71ZNSHqufB'>フィルタ機能</a>よりも優先度が高いことに注意してください。同じ名前のフィルタがある場合、<a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a>が優先されます。</p>
<h3><a name='fJ4r3VpDmqg'></a>6.17 テーブルの生成</h3>
<p>　markdown 書法での<a class='autolink' href='#g6xjP526KX7'>テーブル</a>作成は <a class='term' href='#ahN3t8jbawv'>HTML</a> 直書きよりは簡単ですが、楽しい作業ではありません。特に、頻繁に更新される外部データを毎回変換するような作業の場合は面倒です。そのような場合、内部フィルタの <a class='autolink' href='#fJ4r3VpDmqg'>table</a> が便利かもしれません。以下のようにすれば、CSV形式のデータを<a class='autolink' href='#g6xjP526KX7'>テーブル</a>に変換することができます。</p>
<pre>
~~~table
foo,bar,quux
10,20,30
40,50,60
70,80,90
~~~
</pre>
<p>　外部ファイルからデータをコピーしてくるのが面倒なら、以下のように <code>include</code> で取り込んでしまえば良いでしょう。</p>
<pre>
~~~table
&lt;!-- i​nclude: table.csv --&gt;
~~~
</pre>
<p>　区切り文字はデフォルトでカンマですが、先頭行で指定すれば変更することができます。タブ文字にしたければ以下のようになります。タブ以外の場合は <code>delimiter=</code> に続けて１文字を指定してください<sup><a name='footnote_ref13' href='#footnote13'>13</a></sup>。</p>
<pre>
~~~table
delimiter=tab
foo	bar	quux
10	20	30
40	50	60
70	80	90
~~~
</pre>
<p>　この <code>table</code> フィルタは内部的には「行頭と行末に | を付加し、区切り文字を | に変換」した上で通常の<a class='autolink' href='#g6xjP526KX7'>テーブル</a>として処理する、という方法を取っています。そのため、以下のメリット／デメリットがあります。</p>
<ul>
<li>アライメント指定行が使用できます</li>
<li>出力される<a class='autolink' href='#g6xjP526KX7'>テーブル</a>は<a class='autolink' href='#dOeJnU6OE95'>スタイルスタック</a>の影響を受けます</li>
<li>しかし、変換においては | の前後にスペースを付加しているため、
<ul>
<li><a class='autolink' href='#hVp0EDLBsmJ'>スタイルパレット</a>は使用できません</li>
<li>セル結合もできません</li>
</ul>
</li>
</ul>
<h3><a name='hMHXjTrWEnw'></a>6.18 領域の折り畳み</h3>
<p>　以下のように 2 つの<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>で囲まれた部分は、折り畳み可能な領域になります。その最初の行は常に表示されるタイトルで、クリックするたびに表示状態を切り替えることができます。２行目以降は折り畳まれる部分です。</p>
<pre>
  &lt;!-- collapse:open --&gt;
  TITLE_LINE
      :
      : (contents)
      :
  &lt;!-- collapse:end --&gt;
</pre>
<p>　　</p>
<p>　最初の <code>collapse:</code> に続く <code>open</code> は「初期状態で折り畳まない」という意味で、 <code>close</code> にすると初期状態で折り畳んでおくことができます。また、以前のバージョンとの互換性を保つため、<code>collapse:begin</code> という記述も引き続き有効です。これは <code>collapse:close</code> と同じ意味になります。</p>
<p>　以下に例を示します。以下のように記述すると、</p>
<pre>
&lt;!-- collapse:close --&gt;
タイトル行は@{{color: red;}{文字修飾}}可能。 __クリック__ するたびに状態をトグルできます。
２行目以降は折り畳まれる中身です。通常通り、様々な記述をすることができます。

* contents1
* contents2
* contents3

&lt;!-- collapse:end --&gt;
</pre>
<p>　以下のように表示されます。あと、<a href='#4e69JBVCRLW'>細かい話</a>にも注意事項が書いてありますので参照してください。</p>
<details>
<summary>タイトル行は<span style='color: red;'>文字修飾</span>可能。 <strong>クリック</strong> するたびに状態をトグルできます。</summary>
<p>２行目以降は折り畳まれる中身です。通常通り、様々な記述をすることができます。</p>
<ul>
<li>contents1</li>
<li>contents2</li>
<li>contents3</li>
</ul>
</details>
<h3><a name='a2FYBDWqZUA'></a>6.19 別ファイルの include</h3>
<p>　長大な文書を作成するような場合、章毎にデータファイルを分割したくなるかもしれません。あるいは、サンプルコードを別ファイルにしておき、実際に動作することをいつでも確認できるようにしておきたいかもしれません。理由はさておき、他のファイルの内容を取り込みたい場合には以下のようにすることができます。</p>
<pre>
&lt;!-- include: EXTERNAL_FILE --&gt;
</pre>
<p>　こうしておくと、 <code>EXTERNAL_FILE</code> で指定されたファイルの内容がそこに書いてあったかのように展開されます。この展開はファイルの読み込み時点で実行されるため、<a class='autolink' href='#2HUs4TZfCPd'>preブロック</a>や<a href='#6LkDjrI3ASb'>rawフィルタ</a> の内部に書くことだってできます。つまり、サンプルコードの中身を内部フィルタでコードハイライトさせたければ、以下のようにできるということです。</p>
<pre>
```C
&lt;!-- include: sample.01.c --&gt;
```
</pre>
<p>　include されるファイルの中で、さらに別のファイルを include することもできます。ただし、相互に（あるいは循環的に）include しあうようなファイルを処理することはできません。また、（当たり前ですが）存在しないファイルを指定するとエラーになります。</p>
<p>　include は便利な機能ですが、ひとつ残念な制約があります。include は<a href='#9IN7afRR0hr'>プリプロセス</a>よりも先に実行されるため、 <strong>ファイル名を格納した変数を include のパラメータ部分で展開することはできません。</strong></p>
<h4><a name='7dx1C8sPEB4'></a>6.19.1 起動オプションでの検索パス追加</h4>
<p>　include するファイルは turnup 実行時のカレントディレクトリから検索されますが、起動オプションを指定することで複数のディレクトリを検索パスとして追加することができます。以下のように <code>-IPATH</code> の形式で指定してください。</p>
<pre>
turnup -I../headers -I~/turnup/headers  DATA.md &gt; OUTPUT.htm
</pre>
<p>　include で指定された名前のファイルが複数の検索パスに存在する場合、もっとも優先されるのは「処理中のファイルのあるディレクトリ」にあるファイルで、それに続いて起動オプションで指定された順番になります。<sup><a name='footnote_ref14' href='#footnote14'>14</a></sup></p>
<h3><a name='hs1guSfsFGb'></a>6.20 改ページ指定</h3>
<p>　以下の<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>を記述することで、印刷時にその位置で改ページをすることができます。<sup><a name='footnote_ref15' href='#footnote15'>15</a></sup></p>
<pre>
&lt;!-- embed:pagebreak --&gt;
</pre>
<h3><a name='4eSrElLWBcH'></a>6.21 変数の定義と展開</h3>
<h4><a name='2yDQLphjQX0'></a>6.21.1 データ内での設定と展開</h4>
<p>　変数に値を設定し、任意の場所でその値を展開することができます。変数の定義は以下の要領で記述します。ここでは、変数 FOO に値として 777 を設定しています。</p>
<pre>
&lt;!-- define: FOO = 777 --&gt;
</pre>
<p>　<a class='term' href='#8sf6EgPf8j8'>空白類文字</a>を（特に値の前後端に）含む値を変数に設定したい場合、以下のように値にシングルクォートまたはダブルクォートで括ることができます（この場合クォート文字は値に含まれません）。</p>
<pre>
&lt;!-- define: VAR = ' a b c ' --&gt;
</pre>
<p>　変数名に使用できる文字は英大小文字、数字、およびアンダースコアのみです。また、アンダースコアで始まる名前はシステム用に予約されています。アンダースコアで始まる名前を使用してもエラーにはなりませんが、結果は未定義です。</p>
<p>　設定した変数を参照（展開）するには $​{FOO} または $​(FOO) という要領で指定します。この変数展開は<a href='#9IN7afRR0hr'>プリプロセス段階</a>で実行されるため、バッククォートで括られた<a href='#2TegSYAerqJ'>コード</a>の内部でも展開されます。</p>
<h4><a name='kW5fA3S8XIj'></a>6.21.2 起動オプションでの変数設定</h4>
<p>　変数は起動オプションでも定義することができます。以下のように <code>-DNAME=VALUE</code> の形式で指定してください。</p>
<pre>
turnup -DFOO=777  DATA.md &gt; OUTPUT.htm
</pre>
<p>　この場合、<a class='term' href='#8sf6EgPf8j8'>空白類文字</a>を含めたい場合は以下のようにします。</p>
<pre>
turnup '-DVAR= a b c '  DATA.md &gt; OUTPUT.htm
</pre>
<h4><a name='9Z7pya1EZOR'></a>6.21.3 システム変数</h4>
<p>　<a class='autolink' href='#9Z7pya1EZOR'>システム変数</a>は turnup によって自動的に設定される変数です。以下が用意されています。</p>
<table align='center'>
<tr><th>name</th><th>description</th></tr>
<tr><td align='left'><code>__APP_NAME</code></td><td align='left'>起動された turnup のプログラム名（パスは取り除かれます）</td></tr>
<tr><td align='left'><code>__APP_VERSION</code></td><td align='left'>turnup のバージョン番号（ <code>0.000</code> 形式）</td></tr>
<tr><td align='left'><code>__FILE</code></td><td align='left'>turnup 起動時に指定した入力ファイル名（パスは取り除かれます）</td></tr>
<tr><td align='left'><code>__DATE</code></td><td align='left'>turnup を実行した日付（ <code>YYYY/MM/DD</code> 形式）</td></tr>
<tr><td align='left'><code>__TIME</code></td><td align='left'>turnup を実行した時刻（ <code>HH:MM:DD</code> 形式）</td></tr>
</table>
<h3><a name='8sNFPrNb9kM'></a>6.22 条件分岐</h3>
<p>　簡単な論理式を使用した<a class='autolink' href='#8sNFPrNb9kM'>条件分岐</a>ができます。以下のように、<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>を利用して <code>if, elif, else, endif</code> を記述することができます。 <code>elif, else</code> についてはオプションです。 <code>EXPRESSION</code> で与える条件式が成立した部分だけが出力されます。</p>
<pre>
&lt!-- if: EXPRESSION --&gt
      :
      :
&lt!-- elif: EXPRESSION --&gt
      :
      :
&lt!-- else --&gt
      :
      :
&lt!-- endif --&gt
</pre>
<p>　<code>EXPRESSION</code> で指定する条件式は最大で 4 要素からなる以下のパターンになります。</p>
<table align='center'>
<tr><th>count</th><th>pattern</th><th>description</th></tr>
<tr><td align='center'>0</td><td align='left'></td><td align='left'>常に偽に評価されます</td></tr>
<tr><td align='center'>1</td><td align='left'><code>PARAM</code></td><td align='left'>文字列 <code>PARAM</code> の長さが 1 以上か否か</td></tr>
<tr><td align='center'>2</td><td align='left'><code>! PARAM</code></td><td align='left'>1つめが ! なら上記の否定</td></tr>
<tr><td align='center'>2</td><td align='left'><code>-op PARAM</code></td><td align='left'>1つめが ! 以外なら先頭が演算子</td></tr>
<tr><td align='center'>3</td><td align='left'><code>! -op PARAM</code></td><td align='left'>1つめが ! なら上記の否定</td></tr>
<tr><td align='center'>3</td><td align='left'><code>PARAM1 -op PARAM2</code></td><td align='left'>1つめが ! 以外なら 2 つめが演算子</td></tr>
<tr><td align='center'>4</td><td align='left'><code>! PARAM1 -op PARAM2</code></td><td align='left'>1つめが ! なら上記の否定（それ以外はエラー）</td></tr>
</table>
<p>　具体的なパターンは以下の通りです。</p>
<table align='center'>
<tr><th>expression</th><th>description</th></tr>
<tr><td nowrap align='left'><code>! EXPRSSION</code></td><td align='left'>条件式 <code>EXPRSSION</code> の否定</td></tr>
<tr><td nowrap align='left'><code>STRING</code></td><td align='left'><code>-n STRING</code> と同様</td></tr>
<tr><td nowrap align='left'><code>-n STRING</code></td><td align='left'>文字列 <code>STRING</code> の長さが 0 より大きいか否か</td></tr>
<tr><td nowrap align='left'><code>-z STRING</code></td><td align='left'>文字列 <code>STRING</code> の長さが 0 か否か</td></tr>
<tr><td nowrap align='left'><code>STRING1 == STRING2</code></td><td align='left'>2つの文字列が等しいか否か</td></tr>
<tr><td nowrap align='left'><code>STRING1 != STRING2</code></td><td align='left'>2つの文字列が等しくないか否か</td></tr>
<tr><td nowrap align='left'><code>INTEGER1 -eq INTEGER2</code></td><td align='left'>2つの整数値として比較して等しいか否か</td></tr>
<tr><td nowrap align='left'><code>INTEGER1 -ne INTEGER2</code></td><td align='left'>2つの整数値として比較して等しくないか否か</td></tr>
<tr><td nowrap align='left'><code>INTEGER1 -ge INTEGER2</code></td><td align='left'>2つの整数値として比較して <code>INTEGER1 &gt;= INTEGER2</code> か否か</td></tr>
<tr><td nowrap align='left'><code>INTEGER1 -gt INTEGER2</code></td><td align='left'>2つの整数値として比較して <code>INTEGER1 &gt; INTEGER2</code> か否か</td></tr>
<tr><td nowrap align='left'><code>INTEGER1 -le INTEGER2</code></td><td align='left'>2つの整数値として比較して <code>INTEGER1 &lt;= INTEGER2</code> か否か</td></tr>
<tr><td nowrap align='left'><code>INTEGER1 -lt INTEGER2</code></td><td align='left'>2つの整数値として比較して <code>INTEGER1 &lt; INTEGER2</code> か否か</td></tr>
<tr><td nowrap align='left'><code>FILE1 -nt FILE2</code></td><td align='left'>2つのファイルの更新日付で比較して <code>FILE1</code> の方が新しいか否か</td></tr>
<tr><td nowrap align='left'><code>FILE1 -ot FILE2</code></td><td align='left'>2つのファイルの更新日付で比較して <code>FILE1</code> の方が古いか否か</td></tr>
<tr><td nowrap align='left'><code>-d FILE</code></td><td align='left'><code>FILE</code> がディレクトリとして存在するか否か</td></tr>
<tr><td nowrap align='left'><code>-e FILE</code></td><td align='left'><code>FILE</code> が存在するか否か</td></tr>
<tr><td nowrap align='left'><code>-f FILE</code></td><td align='left'><code>FILE</code> がファイルとして存在するか否か</td></tr>
<tr><td nowrap align='left'><code>-s FILE</code></td><td align='left'><code>FILE</code> がサイズが 0 でないファイルとして存在するか否か</td></tr>
</table>
<h3><a name='anSuBAd7F3R'></a>6.23 マクロ関数</h3>
<p>　<a href='#4eSrElLWBcH'>変数定義</a>機能の拡張として、マクロ関数を利用することができます。これは変数定義において %1 〜 %9 のプレースホルダを埋め込んでおき、変数展開時にパラメータを与えることでこのプレースホルダを置き換えるというものです。</p>
<p>　例として、文字列の色と背景色を反転させてみましょう。マクロ <code>INVERT</code> の定義は以下のようになります。</p>
<pre>
 &lt;!-- define: INVERT = '@((background:darkgray;color:white;)(%1))' --&gt;
</pre>
<p>　マクロにパラメータを与えて展開するには、括弧を余分に使います。変数展開では $ に続いて変数名を {} または () で括るだけでしたが、マクロ関数展開では以下のように記述します。</p>
<pre>
 $​{{NAME}{PARAM1}{PARAM2}...}}
 $​((NAME)(PARAM1)(PARAM2)...))
</pre>
<p>　ここで <code>NAME</code> はマクロ関数の名前、 <code>PARAM1</code> 以降は %1 〜 %9 のプレースホルダを置き換えるためのパラメータです。先程の <code>INVERT</code> マクロを使うのであれば、 <code>$​{{INVERT}{この部分は反転される}}</code> などと記述することになるでしょう。これは以下のように展開され、実際の表示は<span style='background:darkgray;color:white;'>この部分は反転される</span>、となります。</p>
<pre>
 @((background:darkgray;color:white;)(この部分は反転される))
</pre>
<p>　変数とマクロ関数は、定義上では区別はありません。つまり、マクロ関数は「プレースホルダを含む変数」に過ぎないのです。そのため、通常の変数展開の方法で <code>$​{INVERT}</code> とすればプレースホルダを含んだまま（<span style='background:darkgray;color:white;'>%1</span> に）展開されます。</p>
<p>　マクロ関数はあくまで変数展開の一部なので、複数行に渡るブロックに展開されるような使い方は意図していません。複数行のブロックを生成したい場合は、後述する<a href='#8d4GujOuk9v'>スニペット</a>を使用してください。</p>
<h3><a name='8d4GujOuk9v'></a>6.24 スニペット定義と展開</h3>
<p>　<a href='#a2FYBDWqZUA'>include</a> は便利な機能ですが、別ファイルにする理由がない場合は煩雑に感じるかもしれません。一度だけ定義して、繰り返し使いたいパターンがあるだけの場合は、ファイル内で完結する方がよいでしょう。そのような場合には、snippet と expand という<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>が使用できます。</p>
<p>　スニペットの定義は以下のいずれか<sup><a name='footnote_ref16' href='#footnote16'>16</a></sup>の要領で記述します。 <code>NAME</code> 部分には任意の名前を指定してください。</p>
<pre>
&lt;​!-- snippet: NAME
    （ここに繰り返し使いたい内容を記述する）
-​-&gt;

&lt;​!-- snippet: NAME --&gt;
    （ここに繰り返し使いたい内容を記述する）
&lt;​!-- end snippet -​-&gt;
</pre>
<p>　そして、定義したスニペットは名前を指定して expand を使うことでその場所に展開できます。以下のように。</p>
<pre>
&lt;​!-- expand: NAME --&gt;
</pre>
<p>　さらに、<a href='#anSuBAd7F3R'>マクロ関数</a>と同様に %1 〜 %9 のプレースホルダをパラメータで置き換えることができます。これを利用して、expand のたびに異なる出力を生成することができます。パラメータは、スニペット名に続けてスペース（またはタブ）で区切って並べてください。スペースやタブを含むパラメータを指定する場合、シングルクォートまたはダブルクォートで括ります。これらのパラメータは、左から順に %1 %2 %3... と置き換えられます。</p>
<pre>
&lt;​!-- expand: NAME  param1  'param include space'  --&gt;
</pre>
<p>　　</p>
<p>　現在の実装では、スニペットの定義に関していくつかの制約があります。</p>
<ul>
<li>スニペット定義の中でスニペットを定義することはできません（ネストさせられません）</li>
<li>スニペットの内部で他のスニペットを展開することはできません</li>
</ul>
<h3><a name='bs9N19eIT7w'></a>6.25 エラーと警告の出力</h3>
<p>　変数の状態など、特定の状況化ではエラーや警告を出力したい場合があるかもしれません。そのような目的には <code>error</code> および <code>warning</code> が使用できます。</p>
<p>　サンプルを以下に示します。以下の例では、条件式 <code>CONDITION</code> が成立しなかった場合、エラーとしています。</p>
<pre>
&lt!-- if: ! CONDITION --&gt
    &lt!-- error: CONDITION is not true --&gt
&lt!-- endif --&gt
</pre>
<p>　これによって出力されるエラーメッセージは以下のようなものです。類似のメッセージは標準エラー出力にも書き出されます。</p>
<p><span style='background:pink; color:red;'>ERROR : CONDITION is not true</span></p>
<p>　<code>error</code> と <code>warning</code> はともに上記のようなメッセージを出力しますが、 <code>error</code> は文書の生成プロセス全体を中止するのに対し、 <code>warning</code> は処理を続行する点が異なります。</p>
<p>　　</p>
<h2><a name='cNngUDCfTMJ'></a>7 設定</h2>
<h3><a name='0EKpSe2qrxR'></a>7.1 見出しにおける自動リンク</h3>
<p>　<a href='#8mg4uLSAXaz'>キーワードへの自動リンク</a>機能は、デフォルトでは<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>文字列（正確には<a href='#7HkxqP1TWY5'>見出し</a>および<a href='#gg7i7uPfLlo'>図と表のタイトル</a>）には適用されません。これは<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>内にリンクを生成するとうるさくなることや、<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>に存在する文字列は通常そのセクションの本文にも存在することが理由です。</p>
<p>　この挙動を変えたい場合、以下の行を文書内に記載してください。<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>文字列内でも自動リンクが行なわれるようになります。</p>
<pre>
  &lt;!-- config:term-link-in-header --&gt;			
</pre>
<h3><a name='2M8QFQ2XeBn'></a>7.2 見出しの自動ナンバリング</h3>
<p>　<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>に自動的に番号付けを行なうことができます。この機能を有効化するには、以下の設定を文書内に記載します。</p>
<pre>
  &lt;!-- config:header-numbering --&gt;			
</pre>
<p>　これにより、1.1.1. 形式で<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>に自動的に番号が付与されます<sup><a name='footnote_ref17' href='#footnote17'>17</a></sup>。この番号を付与する<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>のレベルを限定したい場合、以下のように記載します。この例では、<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>レベル２〜４の合計３レベルで採番されます。この場合、<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>レベル1、および 5 以降には番号付けは適用されません。</p>
<pre>
  &lt;!-- config:header-numbering 2 4 --&gt;			
</pre>
<h3><a name='hJJbL4GzVpQ'></a>7.3 図表のナンバリング単位</h3>
<p>　<a href='#gg7i7uPfLlo'>図表タイトル</a>、および<a href='#iVFblGs7lu7'>図表一覧生成</a>に適用される番号付けの規則を設定することができます。これには、以下のように記述します。この設定を省略した場合のデフォルト値は 0 です。</p>
<pre>
  &lt;!-- config:entity-numbering-depth 1 --&gt;
</pre>
<p>　0 が指定された場合、図と表それぞれについて、文書全体を通して 1 から始まる連番が付与されます。つまり、図であれば Figure.1 xxxxx、Figure.2 yyyyy といった要領です（表の場合は Table.1 zzzzz）となります。</p>
<p>　1 以上を指定した場合、「<a href='#2M8QFQ2XeBn'>7.2  見出しの自動ナンバリング</a>」で指定した番号付け対象の<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>のうち、先頭から指定した数のレベルを単位として 1 から始まる番号付けを行ないます。こう書くとわかりにくいですが、たとえば以下のようにした場合、</p>
<pre>
  &lt;!-- config:header-numbering 2 4 --&gt;			
  &lt;!-- config:entity-numbering-depth 2 --&gt;
</pre>
<p>まず、ナンバリングをする<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>はレベル 2,3,4 です。そして、図表については<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>レベルの 2,3 が一致するものについて 1 から連番で番号付けをし、これらの<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>レベルが変化するとまた 1 からナンバリングが始まります。なお、この場合は図であれば Figure.1.2-1 xxxxxx といった書式になります。</p>
<h3><a name='jkzhEyZU0ts'></a>7.4 スタイルシートの埋め込み</h3>
<p>　<a href='#kyMp8IkRK8n'>スタイルシートの指定</a>は、デフォルトではスタイルシートの参照が出力されるだけですが、以下の設定が文書内に記述されていると、出力 <a class='term' href='#ahN3t8jbawv'>HTML</a> の内部にスタイルシートの内容を埋め込むようになります。</p>
<pre>
  &lt;!-- config:embed-stylesheet --&gt;			
</pre>
<p>　これによって、以下のように埋め込みが行なわれます。</p>
<pre>
&lt;html&gt;
&lt;header&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
    &lt;meta http-equiv="Content-Style-Type" content="text/css"&gt;
    &lt;title&gt;document title&lt;/title&gt;
  &lt;style&gt;
  &lt;!--
    :
    :
  --&gt;
  &lt;/style&gt;
&lt;/header&gt;
</pre>
<p>　この設定を有効にしてスタイルシートの埋め込みを行なう場合、turnup の実行時点で指定されたスタイルシートのファイルが存在していなければなりません（当たり前ですが）。</p>
<h3><a name='8a3vnTcmVrk'></a>7.5 コメントの出力</h3>
<p>　<a href='#cPmXTXvPhJd'>コメント</a>は記述しても <a class='term' href='#ahN3t8jbawv'>HTML</a> には出力されませんが、以下の設定を文書内に記述することで、この挙動を変えることができます。具体的には、<a class='term' href='#ahN3t8jbawv'>HTML</a> スタイルの<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>をそのまま出力するようになります。<sup><a name='footnote_ref18' href='#footnote18'>18</a></sup></p>
<pre>
  &lt;!-- config:write-comment --&gt;			
</pre>
<p>　　</p>
<h2><a name='4e69JBVCRLW'></a>8 細かい話</h2>
<h3><a name='fSSOiFwQpEj'></a>8.1 入力ファイルのエンコーディングと改行スタイル</h3>
<p>　入力となる <a class='term' href='#b3GXdVHw3CE'>Markdown</a> ファイルのエンコーディングは utf-8 のみですが、改行コードは Lf のみでも CrLf でも動作します。ただし、Lf の方がほんの少し高速になります（誤差程度でしょうけど）。</p>
<h3><a name='9s47bTtYstx'></a>8.2 文字装飾やリンクの制約と継続行</h3>
<p>　リスト要素や文章中に記述できる各種の装飾、リンクなどは、行を跨ぐことはできないので注意してください。単一の行に記述しなければならない記法を複数行に跨がらせたい場合、行末にスペース、バックスラッシュを順に記述することにより行の継続をさせることができます。</p>
<h3><a name='9IN7afRR0hr'></a>8.3 内部的な処理順序</h3>
<p>　turnup に様々な機能が追加された結果、当初は 1-pass だった内部処理も複雑になっていきました。現在では、以下の内部ステップを実行しています。</p>
<table align='center'>
<tr><th>step</th><th>action</th><th>description</th></tr>
<tr><td align='center'>1</td><td nowrap align='left'>入力データのロード</td><td align='left'>指定された入力ファイルとその中の include 指令を再帰的に処理して単一の行シーケンスを生成し、スニペットの展開も行ないます。また、この時点で改行コードの統一や継続行の処理を済ませてしまいます。</td></tr>
<tr><td align='center'>2</td><td nowrap align='left'>プリプロセス</td><td align='left'>入力データの行シーケンスを反復し、変数定義の追跡、および変数展開を実施します。また、<a class='autolink' href='#8sNFPrNb9kM'>条件分岐</a>の処理もこの時点で実施します。</td></tr>
<tr><td align='center'>3</td><td nowrap align='left'>予備スキャン</td><td align='left'>変数展開済みの行シーケンスを反復し、<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>や図表タイトル、用語定義などを解析して各種の<a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a>の利用に備えます。</td></tr>
<tr><td align='center'>4</td><td nowrap align='left'>出力生成</td><td align='left'>行シーケンスを反復し、出力 <a class='term' href='#ahN3t8jbawv'>HTML</a> を生成します。</td></tr>
</table>
<h3><a name='6lxsyJvfG4q'></a>8.4 一部の文字装飾における制約</h3>
<p>　以下の文字装飾において対象範囲を括る（**などの文字列の）ペアのすぐ外側には、 <strong>「<a class='term' href='#8sf6EgPf8j8'>空白類文字</a>でない文字があってはいけません」</strong> 。また、ペアのすぐ内側には <strong>「<a class='term' href='#8sf6EgPf8j8'>空白類文字</a>があってはいけません」</strong> 。</p>
<ul>
<li><a href='#d2FXT7Fqg21'>強調</a></li>
<li><a href='#hBdBkqlaJVW'>取消し線</a></li>
<li><a href='#9k1sm8QrDHi'>マーカー</a></li>
<li><a href='#2TegSYAerqJ'>コード</a></li>
</ul>
<h3><a name='l3wNcsiymoY'></a>8.5 フィルタ機能について</h3>
<p>　turnup が標準で提供する<a class='autolink' href='#f71ZNSHqufB'>フィルタ機能</a>は簡易的なもので、せいぜい<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>と文字列リテラルなどを優先して処理し、あとはキーワードをハイライトする程度です。構文解析などを伴うリッチなコードハイライトが必要な場合、<a href='#18dTPnzNOgg'>外部フィルタの利用</a>を検討してください。</p>
<h3><a name='8pNcG5W73uy'></a>8.6 領域の折り畳みについて</h3>
<p>　<a href='#hMHXjTrWEnw'>領域の折り畳み</a>を可能にする拡張は、スクリプトを使わず、&lt;details&gt; タグを使って実現しています。ひょっとしたら、古いブラウザでは動作しないかもしれません。あと、折り畳まれる対象の中で<a href='#9Dfk88hOKmk'>脚注</a>を使った場合、畳まれた状態では<a class='autolink' href='#9Dfk88hOKmk'>脚注</a>からのリンクをクリックしてもジャンプしないことがわかっていますので注意してください。</p>
<h3><a name='7l2ZW620d5G'></a>8.7 外部フィルタにおける一時ファイル名について</h3>
<p>　<a href='#18dTPnzNOgg'>外部フィルタの登録</a> では、入出力ファイル名として <code>%in</code> および <code>%out</code> というプレースホルダを使用します。実際に使用されるファイル名は、turnup が都度決定すると説明していましたが、ここではその詳細について説明します。</p>
<p>　<a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a>の実行において使用する入出力ファイル名には、フィルタに渡すデータを元に作成したハッシュコードが使用されます。これにより、「同じデータであれば同じファイル名になる」ことが保証されます。このことを利用して、コストのかかる<a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a>実行についてはその出力をキャッシュしておく、といった措置が可能になります（具体的な方法については、<a href='#bCCDfsVD85P'>8.8.1  節</a>などを参照してください）。</p>
<h3><a name='8qCsTwp3HZT'></a>8.8 作図まですべてテキストで実現する方法</h3>
<p>　文書のテキスト管理を徹底しようとすると、ダイアグラムやグラフなどの視覚的な要素が問題になります。アスキーアートは誰もが好きなわけではありませんし、メンテナンスし易いわけでもありません<sup><a name='footnote_ref19' href='#footnote19'>19</a></sup>。他の方法で作図をし、画像ファイルに変換して<a href='#hpQu1WK1Nkr'>貼り付ける</a>こともできますが、それをやった時点で図はテキスト管理から漏れ出してしまいます。ここでは、作図まで全てテキストで頑張るための方法を紹介します。</p>
<h4><a name='bCCDfsVD85P'></a>8.8.1 PlantUML</h4>
<p>　UML を書きたければ、<a class='autolink' href='#bCCDfsVD85P'>PlantUML</a><sup><a name='footnote_ref20' href='#footnote20'>20</a></sup> が現実的な選択肢になります。ダイアグラムの定義はテキストで書くことができますし、出力として SVG 形式を選択すればテキスト形式で turnup の出力 <a class='term' href='#ahN3t8jbawv'>HTML</a> に埋め込むことができます。<a class='autolink' href='#bCCDfsVD85P'>PlantUML</a> の詳細については割愛しますが、<a class='autolink' href='#bCCDfsVD85P'>PlantUML</a> の jar が turnup のデータディレクトリと同じ場所にあるなら、<a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a>の定義は以下のようになるでしょう。</p>
<pre>
&lt;​!-- filter:plantuml = cat %in | java -jar ./plantuml.jar -pipe -tsvg &gt; %out --&gt;
</pre>
<p>　これで、<a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a> <code>plantuml</code> が使えるようになります。<a class='autolink' href='#bCCDfsVD85P'>PlantUML</a> 公式サイトの例を借りるなら、以下のように記述すれば、</p>
<pre>
```plantuml
@startuml
Bob -&gt; Alice : Request
Alice -&gt; Bob : Response
@enduml
```
</pre>
<p>　以下のように埋め込みが行なわれます。図中のテキストも選択・コピーなどが可能であることにご注目。</p>
<div align='center'>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="141px" preserveAspectRatio="none" style="width:136px;height:141px;background:#FFFFFF;" version="1.1" viewBox="0 0 136 141" width="136px" zoomAndPan="magnify"><defs/><g><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="25" x2="25" y1="34" y2="108"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="106.5" x2="106.5" y1="34" y2="108"/><rect fill="#E2E2F0" height="28" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="40" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="12" y="24.3184">Bob</text><rect fill="#E2E2F0" height="28" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="40" x="5" y="107"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26" x="12" y="126.3184">Bob</text><rect fill="#E2E2F0" height="28" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47" x="83.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="90.5" y="24.3184">Alice</text><rect fill="#E2E2F0" height="28" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="47" x="83.5" y="107"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33" x="90.5" y="126.3184">Alice</text><polygon fill="#181818" points="95,59,105,63,95,67,99,63" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="25" x2="101" y1="63" y2="63"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="32" y="59.4385">Request</text><polygon fill="#181818" points="36,86,26,90,36,94,32,90" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="30" x2="106" y1="90" y2="90"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="42" y="86.4385">Response</text><!--MD5=[8e7ee5d8b195a523e828eb5189ffa1bd]
@startuml
Bob -> Alice : Request
Alice -> Bob : Response
@enduml

PlantUML version 1.2022.2(Sun Mar 06 01:30:19 JST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg>
</div>
<p>　　</p>
<p>　<a class='autolink' href='#bCCDfsVD85P'>PlantUML</a> のちょっとだけ残念な点は、Java ベースで動作が緩慢なことです。そのため、大量の UML ダイアグラムを含む文書を turnup にかける場合、無条件に全ダイアグラムを生成すると非常に時間がかかります。そこで、<a href='#7l2ZW620d5G'>一時ファイル名の規則</a>を利用して <a class='autolink' href='#bCCDfsVD85P'>PlantUML</a> の出力をキャッシュしましょう。以下のようなスクリプトを作成して、</p>
<pre class='code'>
<span class='comment'>#!bin/bash</span>

<span class='comment'>#- CAUTION:</span>
<span class='comment'>#- turnup の変数展開を回避するため、$ と { の間で no width space U+200B を使って</span>
<span class='comment'>#- います。コピーして使用する際は no width space U+200B を削除して使ってください。</span>

IN=$1
OUT=$2
CACHE=.cache
JAR=./plantuml.jar
OPT=-Dfile.encoding=UTF-8

<span class='keyword1'>if</span> [ ! -e ./$​{CACHE} ]; <span class='keyword1'>then</span>
    mkdir $​{CACHE}
<span class='keyword1'>fi</span>

<span class='keyword1'>if</span> [ -e ./$​{CACHE}/$​{OUT}.svg ]; <span class='keyword1'>then</span>
    touch ./$​{CACHE}/$​{OUT}.svg
<span class='keyword1'>else</span>
    cat $​{IN} | java $​{OPT} -jar $​{JAR} -pipe -tsvg &gt;&gt; ./$​{CACHE}/$​{OUT}.svg
<span class='keyword1'>fi</span>

<span class='keyword3'>echo</span> <span class='literal'>"&lt;div align='center'&gt;"</span>  &gt; ./$​{OUT}
cat ./$​{CACHE}/$​{OUT}.svg   &gt;&gt; ./$​{OUT}
<span class='keyword3'>echo</span> <span class='literal'>"&lt;/div&gt;"</span>               &gt;&gt; ./$​{OUT}
</pre>
<p><a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a>の定義で使うようにします。これで、.cache というディレクトリに <a class='autolink' href='#bCCDfsVD85P'>PlantUML</a> の出力ファイルがキャッシュされるようになり、turnup の実行時間が改善されます。</p>
<pre>
&lt;!​-- filter:plantuml = bash ./plantuml.sh %in %out --&gt;
</pre>
<p>　　</p>
<h4><a name='8aJF91OqXMS'></a>8.8.2 gnuplot</h4>
<p>　グラフを描画したければ、ひとまずは <a class='autolink' href='#8aJF91OqXMS'>gnuplot</a> が選択肢になります。<a href='#bCCDfsVD85P'>PlantUML の場合</a>同様に出力をキャッシュする前提でスクリプトを置くならば、<a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a>定義は以下のようになるでしょう。</p>
<pre>
&lt;!​-- filter:gnuplot = bash ./gnuplot.sh %in %out --&gt;
</pre>
<p>　このスクリプトの内容は後回しにするとして、<a class='autolink' href='#8aJF91OqXMS'>gnuplot</a> はコマンドファイルとデータを個別に用意する必要があるので、以下のようにハイフンだけの行をセパレータにして両方記述するようにします。前半のコマンド部分では入出力ファイルを <code>in_file, out_file</code> としていますが、これはスクリプトでどうにかします。</p>
<pre>
```gnuplot
set datafile separator ","
set terminal svg size 500,300 fixed
set output out_file
plot in_file using 1:2 with lines notitle, in_file using 1:3 with lines notitle
------------------------------------------------------------------------
0,0,0
1,32,1
2,64,4
   :
   :
38,1216,1444
39,1248,1521
40,1280,1600
```
</pre>
<p>　これで、以下のような SVG 画像が埋め込まれます。</p>
<div align='center'>
<?xml version="1.0" encoding="utf-8"  standalone="no"?>
<svg 
 width="500" height="300"
 viewBox="0 0 500 300"
 xmlns="http://www.w3.org/2000/svg"
 xmlns:xlink="http://www.w3.org/1999/xlink"
>

<title>Gnuplot</title>
<desc>Produced by GNUPLOT 5.2 patchlevel 8 </desc>

<g id="gnuplot_canvas">

<rect x="0" y="0" width="500" height="300" fill="none"/>
<defs>

	<circle id='gpDot' r='0.5' stroke-width='0.5' stroke='currentColor'/>
	<path id='gpPt0' stroke-width='0.222' stroke='currentColor' d='M-1,0 h2 M0,-1 v2'/>
	<path id='gpPt1' stroke-width='0.222' stroke='currentColor' d='M-1,-1 L1,1 M1,-1 L-1,1'/>
	<path id='gpPt2' stroke-width='0.222' stroke='currentColor' d='M-1,0 L1,0 M0,-1 L0,1 M-1,-1 L1,1 M-1,1 L1,-1'/>
	<rect id='gpPt3' stroke-width='0.222' stroke='currentColor' x='-1' y='-1' width='2' height='2'/>
	<rect id='gpPt4' stroke-width='0.222' stroke='currentColor' fill='currentColor' x='-1' y='-1' width='2' height='2'/>
	<circle id='gpPt5' stroke-width='0.222' stroke='currentColor' cx='0' cy='0' r='1'/>
	<use xlink:href='#gpPt5' id='gpPt6' fill='currentColor' stroke='none'/>
	<path id='gpPt7' stroke-width='0.222' stroke='currentColor' d='M0,-1.33 L-1.33,0.67 L1.33,0.67 z'/>
	<use xlink:href='#gpPt7' id='gpPt8' fill='currentColor' stroke='none'/>
	<use xlink:href='#gpPt7' id='gpPt9' stroke='currentColor' transform='rotate(180)'/>
	<use xlink:href='#gpPt9' id='gpPt10' fill='currentColor' stroke='none'/>
	<use xlink:href='#gpPt3' id='gpPt11' stroke='currentColor' transform='rotate(45)'/>
	<use xlink:href='#gpPt11' id='gpPt12' fill='currentColor' stroke='none'/>
	<path id='gpPt13' stroke-width='0.222' stroke='currentColor' d='M0,1.330 L1.265,0.411 L0.782,-1.067 L-0.782,-1.076 L-1.265,0.411 z'/>
	<use xlink:href='#gpPt13' id='gpPt14' fill='currentColor' stroke='none'/>
	<filter id='textbox' filterUnits='objectBoundingBox' x='0' y='0' height='1' width='1'>
	  <feFlood flood-color='white' flood-opacity='1' result='bgnd'/>
	  <feComposite in='SourceGraphic' in2='bgnd' operator='atop'/>
	</filter>
	<filter id='greybox' filterUnits='objectBoundingBox' x='0' y='0' height='1' width='1'>
	  <feFlood flood-color='lightgrey' flood-opacity='1' result='grey'/>
	  <feComposite in='SourceGraphic' in2='grey' operator='atop'/>
	</filter>
</defs>
<g fill="none" color="white" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,264.0 L71.2,264.0 M475.0,264.0 L466.0,264.0  '/>	<g transform="translate(53.9,267.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="end">
		<text><tspan font-family="Arial" > 0</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,233.3 L71.2,233.3 M475.0,233.3 L466.0,233.3  '/>	<g transform="translate(53.9,237.2)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="end">
		<text><tspan font-family="Arial" > 200</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,202.5 L71.2,202.5 M475.0,202.5 L466.0,202.5  '/>	<g transform="translate(53.9,206.4)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="end">
		<text><tspan font-family="Arial" > 400</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,171.8 L71.2,171.8 M475.0,171.8 L466.0,171.8  '/>	<g transform="translate(53.9,175.7)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="end">
		<text><tspan font-family="Arial" > 600</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,141.0 L71.2,141.0 M475.0,141.0 L466.0,141.0  '/>	<g transform="translate(53.9,144.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="end">
		<text><tspan font-family="Arial" > 800</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,110.3 L71.2,110.3 M475.0,110.3 L466.0,110.3  '/>	<g transform="translate(53.9,114.2)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="end">
		<text><tspan font-family="Arial" > 1000</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,79.6 L71.2,79.6 M475.0,79.6 L466.0,79.6  '/>	<g transform="translate(53.9,83.5)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="end">
		<text><tspan font-family="Arial" > 1200</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,48.8 L71.2,48.8 M475.0,48.8 L466.0,48.8  '/>	<g transform="translate(53.9,52.7)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="end">
		<text><tspan font-family="Arial" > 1400</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,18.1 L71.2,18.1 M475.0,18.1 L466.0,18.1  '/>	<g transform="translate(53.9,22.0)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="end">
		<text><tspan font-family="Arial" > 1600</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,264.0 L62.2,255.0 M62.2,18.1 L62.2,27.1  '/>	<g transform="translate(62.2,285.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="middle">
		<text><tspan font-family="Arial" > 0</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M113.8,264.0 L113.8,255.0 M113.8,18.1 L113.8,27.1  '/>	<g transform="translate(113.8,285.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="middle">
		<text><tspan font-family="Arial" > 5</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M165.4,264.0 L165.4,255.0 M165.4,18.1 L165.4,27.1  '/>	<g transform="translate(165.4,285.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="middle">
		<text><tspan font-family="Arial" > 10</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M217.0,264.0 L217.0,255.0 M217.0,18.1 L217.0,27.1  '/>	<g transform="translate(217.0,285.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="middle">
		<text><tspan font-family="Arial" > 15</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M268.6,264.0 L268.6,255.0 M268.6,18.1 L268.6,27.1  '/>	<g transform="translate(268.6,285.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="middle">
		<text><tspan font-family="Arial" > 20</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M320.2,264.0 L320.2,255.0 M320.2,18.1 L320.2,27.1  '/>	<g transform="translate(320.2,285.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="middle">
		<text><tspan font-family="Arial" > 25</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M371.8,264.0 L371.8,255.0 M371.8,18.1 L371.8,27.1  '/>	<g transform="translate(371.8,285.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="middle">
		<text><tspan font-family="Arial" > 30</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M423.4,264.0 L423.4,255.0 M423.4,18.1 L423.4,27.1  '/>	<g transform="translate(423.4,285.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="middle">
		<text><tspan font-family="Arial" > 35</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M475.0,264.0 L475.0,255.0 M475.0,18.1 L475.0,27.1  '/>	<g transform="translate(475.0,285.9)" stroke="none" fill="black" font-family="Arial" font-size="12.00"  text-anchor="middle">
		<text><tspan font-family="Arial" > 40</tspan></text>
	</g>
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,18.1 L62.2,264.0 L475.0,264.0 L475.0,18.1 L62.2,18.1 Z  '/></g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
</g>
	<g id="gnuplot_plot_1" ><title>gnuplot_plot_1</title>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='rgb(148,   0, 211)'  d='M62.2,264.0 L72.5,259.1 L82.8,254.2 L93.2,249.2 L103.5,244.3 L113.8,239.4 L124.1,234.5 L134.4,229.6
		L144.8,224.7 L155.1,219.7 L165.4,214.8 L175.7,209.9 L186.0,205.0 L196.4,200.1 L206.7,195.1 L217.0,190.2
		L227.3,185.3 L237.6,180.4 L248.0,175.5 L258.3,170.6 L268.6,165.6 L278.9,160.7 L289.2,155.8 L299.6,150.9
		L309.9,146.0 L320.2,141.0 L330.5,136.1 L340.8,131.2 L351.2,126.3 L361.5,121.4 L371.8,116.5 L382.1,111.5
		L392.4,106.6 L402.8,101.7 L413.1,96.8 L423.4,91.9 L433.7,87.0 L444.0,82.0 L454.4,77.1 L464.7,72.2
		L475.0,67.3  '/></g>
	</g>
	<g id="gnuplot_plot_2" ><title>gnuplot_plot_2</title>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='rgb(  0, 158, 115)'  d='M62.2,264.0 L72.5,263.8 L82.8,263.4 L93.2,262.6 L103.5,261.5 L113.8,260.2 L124.1,258.5 L134.4,256.5
		L144.8,254.2 L155.1,251.6 L165.4,248.6 L175.7,245.4 L186.0,241.9 L196.4,238.0 L206.7,233.9 L217.0,229.4
		L227.3,224.7 L237.6,219.6 L248.0,214.2 L258.3,208.5 L268.6,202.5 L278.9,196.2 L289.2,189.6 L299.6,182.7
		L309.9,175.5 L320.2,167.9 L330.5,160.1 L340.8,152.0 L351.2,143.5 L361.5,134.7 L371.8,125.7 L382.1,116.3
		L392.4,106.6 L402.8,96.6 L413.1,86.3 L423.4,75.7 L433.7,64.8 L444.0,53.6 L454.4,42.1 L464.7,30.2
		L475.0,18.1  '/></g>
	</g>
<g fill="none" color="white" stroke="rgb(  0, 158, 115)" stroke-width="2.00" stroke-linecap="butt" stroke-linejoin="miter">
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="2.00" stroke-linecap="butt" stroke-linejoin="miter">
</g>
<g fill="none" color="black" stroke="black" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
</g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
	<path stroke='black'  d='M62.2,18.1 L62.2,264.0 L475.0,264.0 L475.0,18.1 L62.2,18.1 Z  '/></g>
<g fill="none" color="black" stroke="currentColor" stroke-width="1.00" stroke-linecap="butt" stroke-linejoin="miter">
</g>
</g>
</svg>

</div>
<p>　　</p>
<p>　最後に、スクリプトの内容を以下に示します。セパレータ行の前後を一時ファイルに振り分けること、入出力ファイルをコマンドファイル冒頭に書き込むことなどがポイントです。なお、エラー処理などは不十分な状態です。</p>
<details>
<summary><a class='autolink' href='#8aJF91OqXMS'>gnuplot</a>.sh の内容はこちら</summary>
<pre class='code'>
<span class='comment'>#!/bin/bash</span>

<span class='comment'>#- CAUTION:</span>
<span class='comment'>#- turnup の変数展開を回避するため、$ と { の間で no width space U+200B を使って</span>
<span class='comment'>#- います。コピーして使用する際は no width space U+200B を削除して使ってください。</span>

IN=$1
OUT=$2
CACHE=.cache
APP=gnuplot

<span class='keyword1'>if</span> [ ! -e ./$​{CACHE} ]; <span class='keyword1'>then</span>
    mkdir $​{CACHE}
<span class='keyword1'>fi</span>

<span class='keyword1'>if</span> [ -e ./$​{CACHE}/$​{OUT}.svg ]; <span class='keyword1'>then</span>
    touch ./$​{CACHE}/$​{OUT}.svg
<span class='keyword1'>else</span>
    LINENUM=`grep -n <span class='literal'>'^-\+$'</span> $​{IN} | perl -pe <span class='literal'>'s/^(\d):-+$/\1/'</span>`
    LINECNT=`cat $​{IN} | wc -l`
    <span class='keyword1'>if</span> [ ! -z <span class='literal'>"$​{LINENUM}"</span> ]; <span class='keyword1'>then</span>
        <span class='keyword3'>echo</span> <span class='literal'>"in_file=\"$​{IN}.dat\""</span> &gt; $​{IN}.gp
        <span class='keyword3'>echo</span> <span class='literal'>"out_file=\"./$​{CACHE}/$​{OUT}.svg\""</span> &gt;&gt; $​{IN}.gp
        head -$((LINENUM - 1)) $​{IN} &gt;&gt; $​{IN}.gp
        tail -$((LINECNT - LINENUM)) $IN &gt; $​{IN}.dat
        $APP $​{IN}.gp
        rm $​{IN}.gp
        rm $​{IN}.dat
    <span class='keyword1'>fi</span>
<span class='keyword1'>fi</span>

<span class='keyword3'>echo</span> <span class='literal'>"&lt;div align='center'&gt;"</span>  &gt; ./$​{OUT}
cat ./$​{CACHE}/$​{OUT}.svg   &gt;&gt; ./$​{OUT}
<span class='keyword3'>echo</span> <span class='literal'>"&lt;/div&gt;"</span>               &gt;&gt; ./$​{OUT}
</pre>
</details>
<h3><a name='62CICfavwWM'></a>8.9 画像ファイルを HTML 内に取り込む方法</h3>
<p>　<a href='#8qCsTwp3HZT'>前節</a>ではテキストで作図をする方法をいくつか紹介しましたが、ここでは png 形式などの画像ファイルを出力 <a class='term' href='#ahN3t8jbawv'>HTML</a> ファイル内に埋め込む方法を紹介します<sup><a name='footnote_ref21' href='#footnote21'>21</a></sup>。</p>
<p>　<a href='#8qCsTwp3HZT'>前節</a>と同じように、<a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a>を定義します（内容については後述）。</p>
<pre>
&lt;!​-- filter:embed_image = bash ./embed_image.sh %in %out --&gt;
</pre>
<p>　この<a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a>は以下のように使用します。つまり、埋め込みたいファイル名を指定します。</p>
<pre>
```embed_image
./tmp.png
```
</pre>
<p>　これによって、以下のような内容が埋め込まれます。</p>
<pre>
&lt;div align='center'&gt;
  &lt;img src='data:image/png;base64,iVBORw0K...(omit)...K5CYII=' /&gt;
&lt;/div&gt;
</pre>
<p>　　</p>
<p>　最後に、スクリプトの内容を以下に示します。</p>
<details>
<summary>embed_image.sh の内容はこちら</summary>
<p>　このスクリプトについては、以下の点に注意してください。</p>
<ul>
<li>MIME タイプの <code>image/</code> に後続する部分はファイルの拡張子から取っています。</li>
<li>base64 を使うため、元の画像ファイルの 4/3 倍のサイズのテキストを埋め込むことになります。</li>
</ul>
<pre class='code'>
<span class='comment'>#!/bin/bash</span>

<span class='comment'>#- CAUTION:</span>
<span class='comment'>#- turnup の変数展開を回避するため、$ と { の間で no width space U+200B を使って</span>
<span class='comment'>#- います。コピーして使用する際は no width space U+200B を削除して使ってください。</span>

IN=$1
OUT=$2
CACHE=.cache

<span class='keyword1'>if</span> [ ! -e ./$​{CACHE} ]; <span class='keyword1'>then</span>
    mkdir $​{CACHE}
<span class='keyword1'>fi</span>

<span class='keyword1'>if</span> [ -e ./$​{CACHE}/$​{OUT}.dat ]; <span class='keyword1'>then</span>
    touch ./$​{CACHE}/$​{OUT}.dat
<span class='keyword1'>else</span>
    FILE=`cat <span class='literal'>"$​{IN}"</span>`
    TYPE=`<span class='keyword3'>echo</span> $​{FILE} | perl -pe <span class='literal'>"s/^.+\.(.+)$/\1/"</span>`
    <span class='keyword3'>echo</span> -n <span class='literal'>"&lt;img src='data:image/$​{TYPE};base64,"</span> &gt; ./$​{CACHE}/$​{OUT}.dat
    base64 $​{FILE} &gt;&gt; ./$​{CACHE}/$​{OUT}.dat
    <span class='keyword3'>echo</span> <span class='literal'>"' /&gt;"</span>  &gt;&gt; ./$​{CACHE}/$​{OUT}.dat
<span class='keyword1'>fi</span>

<span class='keyword3'>echo</span> <span class='literal'>"&lt;div align='center'&gt;"</span>  &gt; ./$​{OUT}
cat ./$​{CACHE}/$​{OUT}.dat   &gt;&gt; ./$​{OUT}
<span class='keyword3'>echo</span> <span class='literal'>"&lt;/div&gt;"</span>               &gt;&gt; ./$​{OUT}
</pre>
</details>
<h2><a name='8tTIqHSNoTg'></a>9 既知の問題点</h2>
<h3><a name='95miNJcW6DM'></a>9.1 【解決済】リンクテキストの末尾に文字装飾があると正しく処理されない</h3>
<details>
<summary>　この問題は 2021/09/12 に修正されました（まだバージョン番号の管理を始めていないので日付で記載しています）。</summary>
<p>　リンクテキストの末尾に文字装飾があると正しく処理されない問題が確認されています。たとえば、<code>[Table of __contents__](#Table of contents)</code> は <code>Table of __contents__</code> と表示されてしまいます。</p>
<p>　<strike>内部実装に問題があることが確認できていますが、修正が少々面倒なため着手できてません。</strike></p>
</details>
<p>　　</p>
<h3><a name='kjPiZRKvp7P'></a>9.2 【解決済】テーブルで colspan/rowspan を使うとアライメント指定がずれる</h3>
<details>
<summary>アライメント指定行を任意の位置に複数記述可能とすることでユーザーデータでの対処を可能にする修正を行ないました。詳細は<a class='autolink' href='#g6xjP526KX7'>テーブル</a>の説明を参照してください。</summary>
<p>　<a class='autolink' href='#g6xjP526KX7'>テーブル</a>において列毎のアライメント指定と横／縦方向のセル結合を併用すると意図したようにアライメントが設定されない問題があります。これは、セルの処理においてセル結合の情報を考慮に入れていないために発生します。たとえば、以下の例では水平方向の結合によってそれよりも右側のセルで問題が生じています。</p>
<pre>
| column A | column B | column C |
|:---------|:--------:|---------:|
|left      |center    |right     |
|2&gt; left              |right?    |
|left      |center    |right     |
</pre>
<table align='center'>
<tr><th>column A</th><th>column B</th><th>column C</th></tr>
<tr><td align='left'>left</td><td align='center'>center</td><td align='right'>right</td></tr>
<tr><td align='left' colspan='2'>left</td><td style="background: #fff0f0;" align='center'>right?</td></tr>
<tr><td align='left'>left</td><td align='center'>center</td><td align='right'>right</td></tr>
</table>
<p>　上記のような例では、問題は行に閉じているため対処は簡単だと思うかもしれません。しかし、縦方向の結合では先行する行の影響を受けることがわかります。</p>
<pre>
| column A | column B | column C |
|:---------|:--------:|---------:|
|2^ left   |center    |right     |
           |center?   |right?    |
|left      |center    |right     |
</pre>
<table align='center'>
<tr><th>column A</th><th>column B</th><th>column C</th></tr>
<tr><td align='left' rowspan='2'>left</td><td align='center'>center</td><td align='right'>right</td></tr>
<tr><td style="background: #fff0f0;" align='left'>center?</td><td style="background: #fff0f0;" align='center'>right?</td></tr>
<tr><td align='left'>left</td><td align='center'>center</td><td align='right'>right</td></tr>
</table>
<p>　さらに、これらのセル結合指定が複合した場合、プログラムとして正し処理を行なうのは難しくなります。この問題に対する対処は未定ですが、コードで頑張ることは避け、アライメント指定行を任意の位置に複数記述可能とすることでユーザーデータでの対処を可能にする方向で検討中です。</p>
</details>
<h3><a name='78o6GpB2DHz'></a>9.3 【解決済】条件分岐でファイル存在チェックをしても include がエラーになる</h3>
<details>
<summary>　この問題は version 0.804 で修正されました。</summary>
<p>　<a href='#9IN7afRR0hr'>内部的な処理順序</a> で説明している通り、<a href='#a2FYBDWqZUA'>別ファイルの include</a>はプリプロセスに先行して実施されます。そのため、以下のように「ファイルが存在した場合だけ include する」という意図で書かれた以下のコードは期待される動作をしませんでした（入力データのロード時点でエラー終了してしまいます）。</p>
<pre>
&lt!-- if: -f foo.txt --&gt
  &lt!-- include: foo.txt --&gt
&lt!-- endif --&gt
</pre>
<p>　この問題を解決するために、include の際のエラー出力方式変更を実施しました。具体的には、入力データのロード時点ではエラー終了とせず、include 箇所に <a href='#bs9N19eIT7w'>errorディレクティブ</a>を埋め込むようにしました。これにより、エラー処理が出力生成段階まで遅延されることになり、<a class='autolink' href='#8sNFPrNb9kM'>条件分岐</a>で適切に括られていれば意図した動作をする（エラーが回避できる）ことになります。</p>
</details>
<h3><a name='brtS2jyAYs6'></a>9.4 【解決済】C/C++ のコードハイライトで #if や #else が正しく処理されない</h3>
<details>
<summary>　この問題は version 0.808 で修正されました。</summary>
<p>　<a href='#f71ZNSHqufB'>C/C++ のコードハイライト</a>に問題があり、 <code>#if</code> や <code>#else</code> が正しく処理されません。先に <code>if</code> や <code>else</code> が正しく処理されてしまうバグがあり、以下のようになってしまいます。</p>
<pre class='code'>
<span class='keyword2'>int</span> main( <span class='keyword2'>int</span> argc, <span class='keyword2'>char</span>* argv[] ) {
#<span class='keyword1'>if</span> 0
    foo();
#<span class='keyword1'>else</span>
    bar();
<span class='keyword3'>#endif</span>
    <span class='keyword1'>return</span> 0;
}
</pre>
<p>　この問題を解決するために、キーワードの処理順序を変更しました。以下のように正しくハイライトされるように修正済みです。</p>
<pre class='code'>
<span class='keyword2'>int</span> main( <span class='keyword2'>int</span> argc, <span class='keyword2'>char</span>* argv[] ) {
<span class='keyword3'>#if</span> 0
    foo();
<span class='keyword3'>#else</span>
    bar();
<span class='keyword3'>#endif</span>
    <span class='keyword1'>return</span> 0;
}
</pre>
</details>
<h3><a name='dguaQPYtqQN'></a>9.5 【解決済】リストの仕様が一般的な markdown と異なる</h3>
<details>
<summary>　この問題は version 0.816 で修正されました。</summary>
<p>　一般的な markdown では、リストや番号付きリストの処理はかなり柔軟に行なわれますが、それと比較すると turnup のリスト処理は限定的でした。version 0.816 において、一般的な markdown の処理にあわせる対処を実施しました。</p>
</details>
<p>　　</p>
<h2><a name='dGdSPnvay5N'></a>10 更新履歴</h2>
<p>　更新履歴です。2021/09/26 以降バージョン番号の付与を開始しました。</p>
<ul>
<li><strong>2021/07/23</strong>
<ul>
<li>ENHANCE : <a href='#18dTPnzNOgg'>外部フィルタ</a>機構の導入</li>
<li>REFACTORING : 内部的な修正</li>
</ul>
</li>
<li><strong>2021/07/27</strong>
<ul>
<li>BUGFIX : <a href='#18dTPnzNOgg'>外部フィルタ</a>を使用する場合の一時ファイル保存にまつわるバグを修正</li>
<li>ENHANCE : <a href='#gg7i7uPfLlo'>図表タイトル</a>の記法と一覧作成機能の実装</li>
</ul>
</li>
<li><strong>2021/07/28</strong>
<ul>
<li>ENHANCE : <a href='#9Dfk88hOKmk'>脚注</a>に専用の class を用意</li>
<li>ENHANCE : <a href='#cjJv49XsD9d'>ページ内アンカーへのリンク</a>に省略記法を用意</li>
</ul>
</li>
<li><strong>2021/07/29</strong>
<ul>
<li>BUGFIX : 単独の ! が [ に化ける凡ミスを修正</li>
</ul>
</li>
<li><strong>2021/08/12</strong>
<ul>
<li>ENHANCE : <a href='#f71ZNSHqufB'>diff のハイライト</a>を内部フィルタとして実装</li>
</ul>
</li>
<li><strong>2021/08/15</strong>
<ul>
<li>ENHANCE : <a href='#f71ZNSHqufB'>C/C++ のコードハイライト</a>を内部フィルタとして実装</li>
</ul>
</li>
<li><strong>2021/08/16</strong>
<ul>
<li>BUGFIX : <a href='#f71ZNSHqufB'>コードハイライト</a>対象冒頭にキーワードがあると処理されない問題の修正</li>
<li>BUGFIX : <a href='#g6xjP526KX7'>テーブル</a>ヘッダ行にも align が出力される問題の修正</li>
<li>CSS : <a class='autolink' href='#fJ4r3VpDmqg'>table</a> header の背景色スタイルを変更</li>
<li>ENHANCE : <a href='#hs1guSfsFGb'>改ページ指定</a>の機能を追加</li>
</ul>
</li>
<li><strong>2021/08/17</strong>
<ul>
<li>ENHANCE : <a href='#g6xjP526KX7'>テーブル</a>と<a href='#hpQu1WK1Nkr'>画像</a>は常にセンタリングされるように変更（暫定対処になるかも）</li>
<li>ENHANCE : <a href='#akoPHkUM3jR'>改行の挿入</a>をサポート</li>
<li>ENHANCE : <a href='#9PbJaRizVB7'>定義リスト</a>において用語の前後のスペースの扱いを緩和し、明確化</li>
<li>ENHANCE : <a href='#2Hh9eF0BTk3'>インラインスタイル指定</a>のサポートを追加</li>
<li>ENHANCE : <a href='#g6xjP526KX7'>テーブル</a>で nowrap を指定させる拡張を追加</li>
<li>ENHANCE : <a href='#hMHXjTrWEnw'>領域の折り畳み</a>を可能にする拡張を追加</li>
</ul>
</li>
<li><strong>2021/08/18</strong>
<ul>
<li>BUGFIX : リンクラベル内部に定義用語があるとリンクがネストする問題の修正</li>
<li>ENHANCE : 空行に加えて<a class='autolink' href='#cPmXTXvPhJd'>コメント</a>行も段落の終了とみなすように変更</li>
<li>BUGFIX : 各種タイトル（<a class='autolink' href='#7HkxqP1TWY5'>見出し</a>、<a class='autolink' href='#g6xjP526KX7'>テーブル</a>、ヘッダ）、および用語が同名でも異なるリンク用ハッシュコードを生成するように修正</li>
</ul>
</li>
<li><strong>2021/08/19</strong>
<ul>
<li>ENHANCE : <a href='#dOeJnU6OE95'>スタイルスタック</a>拡張を追加</li>
</ul>
</li>
<li><strong>2021/08/20</strong>
<ul>
<li>BUGFIX : 直前の<a class='autolink' href='#g6xjP526KX7'>テーブル</a>の nowrap 指定が次の<a class='autolink' href='#g6xjP526KX7'>テーブル</a>のヘッダに適用されてしまう問題の修正</li>
</ul>
</li>
<li><strong>2021/08/22</strong>
<ul>
<li>ENHANCE : 名前の衝突をチェックしてエラーを出力するように変更</li>
<li>ENHANCE : <a href='#hMHXjTrWEnw'>領域の折り畳み</a>における用語自動リンクに関するバグを修正</li>
<li>ENHANCE : スペース＋バックスラッシュを使用した継続行の機能を追加</li>
</ul>
</li>
<li><strong>2021/08/25</strong>
<ul>
<li>ENHANCE : <a href='#hVp0EDLBsmJ'>スタイルパレット</a>拡張を追加</li>
<li>ENHANCE : <a href='#g6xjP526KX7'>テーブル</a>におけるヘッダ／データ境界行の扱いを拡張（複数行ヘッダを許可）</li>
<li>ENHANCE : <a href='#g6xjP526KX7'>テーブル</a>における colspan 指定の拡張を追加</li>
</ul>
</li>
<li><strong>2021/08/31</strong>
<ul>
<li>BUGFIX : <a href='#d2FXT7Fqg21'>強調</a>、<a href='#hBdBkqlaJVW'>取消し線</a>、<a href='#9k1sm8QrDHi'>マーカー</a>、<a href='#2TegSYAerqJ'>コード</a> の<a href='#6lxsyJvfG4q'>適用条件を変更</a></li>
<li>BUGFIX : <a href='#7maM1Z8DaEp'>目次</a>と<a href='#iVFblGs7lu7'>図表一覧</a>、および<a href='#7HkxqP1TWY5'>見出し</a>や<a href='#gg7i7uPfLlo'>図表タイトル</a>へのリンクにおいて文字装飾が正しく処理されない問題を修正</li>
</ul>
</li>
<li><strong>2021/09/04</strong>
<ul>
<li>BUGFIX : <a href='#7HkxqP1TWY5'>見出し</a>や<a href='#gg7i7uPfLlo'>図表タイトル</a>の末尾に<a class='term' href='#8sf6EgPf8j8'>空白類文字</a>があると出力にゴミが混じる問題を修正</li>
<li>ENHANCE : <a href='#g6xjP526KX7'>テーブル</a>における rowspan 指定の拡張を追加</li>
<li>REFACTORING : 内部実装を整理</li>
<li>ENHANCE : <a href='#a2FYBDWqZUA'>別ファイルの include</a> をサポートする拡張を追加</li>
<li>BUGFIX : <a href='#jkzhEyZU0ts'>スタイルシートの埋め込み</a>設定時に指定 css ファイルが存在しないとクラッシュする問題を修正</li>
</ul>
</li>
<li><strong>2021/09/11</strong>
<ul>
<li>BUGFIX : <a href='#kjPiZRKvp7P'>テーブルで colspan/rowspan を使うとアライメント指定がずれる問題</a>に対処する機能を追加</li>
</ul>
</li>
<li><strong>2021/09/12</strong>
<ul>
<li>BUGFIX : <a href='#95miNJcW6DM'>リンクテキストの末尾に文字装飾があると正しく処理されない問題</a>を修正</li>
<li>ENHANCE : <a href='#f71ZNSHqufB'>シェルスクリプトのコードハイライト</a>を内部フィルタとして実装 ( experimental )</li>
</ul>
</li>
<li><strong>2021/09/21</strong>
<ul>
<li>ENHANCE : <code>@((STYLES)(CONTENTS))</code> 形式での<a href='#2Hh9eF0BTk3'>インラインスタイル指定</a>を可能にする修正</li>
</ul>
</li>
<li><strong>2021/09/25</strong>
<ul>
<li>ENHANCE : <a href='#4eSrElLWBcH'>変数の定義と展開</a>機能を追加</li>
</ul>
</li>
<li><strong>2021/09/26 - version 0.800</strong>
<ul>
<li>ENHANCE : バージョン番号の付与を開始</li>
<li>ENHANCE : 起動オプション --version でバージョン情報を表示</li>
</ul>
</li>
<li><strong>2021/10/03 - version 0.801</strong>
<ul>
<li>ENHANCE : 起動オプション <code>-DSYMBOL=VALUE</code> での<a href='#4eSrElLWBcH'>変数定義</a>サポートの追加</li>
</ul>
</li>
<li><strong>2021/10/11 - version 0.802</strong>
<ul>
<li>ENHANCE : <a href='#9Z7pya1EZOR'>システム変数</a>を追加</li>
<li>ENHANCE : <a href='#8sNFPrNb9kM'>条件分岐</a>機能を追加</li>
</ul>
</li>
<li><strong>2021/10/12 - version 0.803</strong>
<ul>
<li>BUGFIX : <a href='#8sNFPrNb9kM'>条件分岐</a>機能における <code>elif</code> で変数展開されない問題を修正</li>
<li>ENHANCE : <a href='#bs9N19eIT7w'>エラーと警告の出力</a>機能を追加</li>
</ul>
</li>
<li><strong>2021/10/14 - version 0.804</strong>
<ul>
<li>BUGFIX : <a href='#78o6GpB2DHz'>条件分岐と include に関する問題</a>を修正</li>
</ul>
</li>
<li><strong>2021/10/23 - version 0.805</strong>
<ul>
<li>REFACTORING : 内部実装を整理（実行時文字列作成機能を集約）</li>
<li>ENHANCE : <a href='#a2FYBDWqZUA'>別ファイルの include</a>機能で検索パスを指定する機能を追加</li>
</ul>
</li>
<li><strong>2021/11/03 - version 0.806</strong>
<ul>
<li>BUGFIX : <a href='#a2FYBDWqZUA'>別ファイルの include</a>機能でファイル検索順序に関する仕様の曖昧さを修正</li>
</ul>
</li>
<li><strong>2021/11/07 - version 0.807</strong>
<ul>
<li>ENHANCE : <a href='#anSuBAd7F3R'>マクロ関数</a>機能を追加</li>
<li>ENHANCE : <a href='#4eSrElLWBcH'>変数展開</a>と<a href='#anSuBAd7F3R'>マクロ</a>で {} だけでなく () も使えるように変更</li>
</ul>
</li>
<li><strong>2021/12/18 - version 0.808</strong>
<ul>
<li>BUGFIX : <a href='#brtS2jyAYs6'>C/C++ のコードハイライトに関する問題</a>を修正</li>
</ul>
</li>
<li><strong>2021/12/28 - version 0.809</strong>
<ul>
<li>BUGFIX : <a href='#a2FYBDWqZUA'>include</a>機能のバグを修正</li>
</ul>
</li>
<li><strong>2022/03/06 - version 0.810</strong>
<ul>
<li>ENHANCE : <a href='#f71ZNSHqufB'>Common LISP 言語のコードハイライト</a>を内部フィルタとして実装</li>
</ul>
</li>
<li><strong>2022/03/13 - version 0.811</strong>
<ul>
<li>ENHANCE : <a href='#8d4GujOuk9v'>スニペット定義と展開</a>機能を追加 ( experimental )</li>
</ul>
</li>
<li><strong>2022/04/05 - version 0.812</strong>
<ul>
<li>ENHANCE : 自動リンク機能を追加</li>
<li>ENHANCE : 上記に伴い、<a href='#8mg4uLSAXaz'>6.9  節</a>を追記・改変</li>
</ul>
</li>
<li><strong>2022/04/06 - version 0.813</strong>
<ul>
<li>ENHANCE : 自動リンク機能において <code>TITLE</code> に空文字列を指定した場合とエラーとする修正</li>
<li>ENHANCE : 自動リンク機能において <code>TITLE</code> に <code>$$</code> を使用できるように変更</li>
</ul>
</li>
<li><strong>2022/04/07 - version 0.814</strong>
<ul>
<li>ENHANCE : <a href='#iYSlVZhYmRM'>番号付きリスト</a>における番号付与のルールを変更</li>
</ul>
</li>
<li><strong>2022/04/09 - version 0.815</strong>
<ul>
<li>ENHANCE : <a href='#hMHXjTrWEnw'>領域の折り畳み</a>において初期状態の指定を可能にする変更</li>
<li>ENHANCE : <a class='autolink' href='#f71ZNSHqufB'>フィルタ機能</a>に <code>raw</code> を追加し、<a href='#6LkDjrI3ASb'>&lt;raw_html&gt; を非推奨とする</a>変更</li>
<li>ENHANCE : 折り畳み可能な<a href='#7maM1Z8DaEp'>目次の生成</a>のための <code>embed:toc-x</code> を追加</li>
<li>ENHANCE : <a class='autolink' href='#f71ZNSHqufB'>フィルタ機能</a>に <code>table</code> を追加（<a href='#fJ4r3VpDmqg'>6.17  節</a>参照）</li>
<li>ENHANCE : <a href='#dguaQPYtqQN'>リストの仕様が一般的な markdown と異なる</a>件を<a class='autolink' href='#8tTIqHSNoTg'>既知の問題点</a>として計上</li>
</ul>
</li>
<li><strong>2022/04/24 - version 0.816</strong>
<ul>
<li>ENHANCE : <a href='#dguaQPYtqQN'>リストの仕様が一般的な markdown と異なる</a>問題の修正</li>
</ul>
</li>
<li><strong>2022/04/24 - version 0.817</strong>
<ul>
<li>ENHANCE : <a href='#2c4WKrG50Sg'>引用</a>ブロックの仕様をリスト同様に変更</li>
</ul>
</li>
<li><strong>2022/05/01 - version 0.818</strong>
<ul>
<li>ENHANCE : <a href='#8d4GujOuk9v'>スニペット</a>の仕様を拡張し、パラメータ展開をサポート</li>
<li>DOCUMENT : 「<a href='#8qCsTwp3HZT'>8.8  作図まですべてテキストで実現する方法</a>」 を追加</li>
<li>ENHANCE : <a href='#bZZIHdLJ79G'>目次へのリンクボタン表示</a>機能を追加</li>
</ul>
</li>
<li><strong>2022/05/08 - version 0.819</strong>
<ul>
<li>ENHANCE : 任意の場所に<a class='autolink' href='#4e8Wf4oSDqx'>アンカー</a>を埋め込む機能を追加</li>
<li>ENHANCE : <a class='autolink' href='#2C50p0Hw1s1'>索引の生成</a>機能を追加</li>
</ul>
</li>
<li><strong>2022/06/12 - version 0.820</strong>
<ul>
<li>DOCUMENT : 「<a href='#62CICfavwWM'>8.9  画像ファイルを HTML 内に取り込む方法</a>」 を追加</li>
</ul>
</li>
</ul>
<p>　　</p>
<h2><a name='1ewHzjI62xn'></a>11 索引</h2>
<p>　<a class='autolink' href='#2C50p0Hw1s1'>索引の生成</a>機能の使用サンプルを兼ねています。</p>
<details class='idx_x' open>
<summary class='idx_x'>Symbols</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#kW5fA3S8XIj'>-D オプション</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>A</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#4e8Wf4oSDqx'>anchor</a></li>
<li class='idx_x'><a class='autolink' href='#8mg4uLSAXaz'>autolink</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>B</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#2c4WKrG50Sg'>blockquote</a></li>
<li class='idx_x'><a class='autolink' href='#akoPHkUM3jR'>brタグ</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>C</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#hMHXjTrWEnw'>collapse:</a></li>
<li class='idx_x'><a class='autolink' href='#jkzhEyZU0ts'>config:embed-stylesheet</a></li>
<li class='idx_x'><a class='autolink' href='#hJJbL4GzVpQ'>config:entity-numbering-depth</a></li>
<li class='idx_x'><a class='autolink' href='#2M8QFQ2XeBn'>config:header-numbering</a></li>
<li class='idx_x'><a class='autolink' href='#0EKpSe2qrxR'>config:term-link-in-header</a></li>
<li class='idx_x'><a class='autolink' href='#8a3vnTcmVrk'>config:write-comment</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>D</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#2yDQLphjQX0'>define:</a></li>
<li class='idx_x'><a class='autolink' href='#8pNcG5W73uy'>detailsタグ</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>E</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#jkzhEyZU0ts'>embed-stylesheet</a></li>
<li class='idx_x'><a class='autolink' href='#iVFblGs7lu7'>embed:figure-list</a></li>
<li class='idx_x'><a class='autolink' href='#9Dfk88hOKmk'>embed:footnotes</a></li>
<li class='idx_x'><a class='autolink' href='#2C50p0Hw1s1'>embed:index</a></li>
<li class='idx_x'><a class='autolink' href='#2C50p0Hw1s1'>embed:index-x</a></li>
<li class='idx_x'><a class='autolink' href='#hs1guSfsFGb'>embed:pagebreak</a></li>
<li class='idx_x'><a class='autolink' href='#iVFblGs7lu7'>embed:table-list</a></li>
<li class='idx_x'><a class='autolink' href='#7maM1Z8DaEp'>embed:toc</a></li>
<li class='idx_x'><a class='autolink' href='#7maM1Z8DaEp'>embed:toc-x</a></li>
<li class='idx_x'><a class='autolink' href='#hJJbL4GzVpQ'>entity-numbering-depth</a></li>
<li class='idx_x'><a class='autolink' href='#bs9N19eIT7w'>error:</a></li>
<li class='idx_x'><a class='autolink' href='#8d4GujOuk9v'>expand:</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>F</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#18dTPnzNOgg'>filter:</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>G</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='term' href='#fgvQnqibuC4'>GFM</a></li>
<li class='idx_x'><a class='autolink' href='#8aJF91OqXMS'>gnuplot</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>H</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='term' href='#ahN3t8jbawv'>HTML</a></li>
<li class='idx_x'><a class='autolink' href='#2M8QFQ2XeBn'>header-numbering</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>I</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#8sNFPrNb9kM'>if:</a></li>
<li class='idx_x'><a class='autolink' href='#a2FYBDWqZUA'>include:</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>M</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='term' href='#b3GXdVHw3CE'>Markdown</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>P</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#bCCDfsVD85P'>PlantUML</a></li>
<li class='idx_x'><a class='autolink' href='#hVp0EDLBsmJ'>pallete:</a></li>
<li class='idx_x'><a class='autolink' href='#2HUs4TZfCPd'>preブロック</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>R</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#6LkDjrI3ASb'>raw</a></li>
<li class='idx_x'><a class='autolink' href='#6LkDjrI3ASb'>raw_html</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>S</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#8d4GujOuk9v'>snippet:</a></li>
<li class='idx_x'><a class='autolink' href='#dOeJnU6OE95'>stack:pop</a></li>
<li class='idx_x'><a class='autolink' href='#dOeJnU6OE95'>stack:push</a></li>
<li class='idx_x'><a class='autolink' href='#kyMp8IkRK8n'>style:</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>T</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#fJ4r3VpDmqg'>table</a></li>
<li class='idx_x'><a class='autolink' href='#0EKpSe2qrxR'>term-link-in-header</a></li>
<li class='idx_x'><a class='autolink' href='#kyMp8IkRK8n'>title:</a></li>
<li class='idx_x'><a class='autolink' href='#bZZIHdLJ79G'>toc-link:</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>W</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#bs9N19eIT7w'>warning:</a></li>
<li class='idx_x'><a class='autolink' href='#8a3vnTcmVrk'>write-comment</a></li>
</blockquote>
</details>
<details class='idx_x' open>
<summary class='idx_x'>Others</summary>
<blockquote class='idx_x'>
<li class='idx_x'><a class='autolink' href='#4e8Wf4oSDqx'>アンカー</a></li>
<li class='idx_x'><a class='autolink' href='#2Hh9eF0BTk3'>インラインスタイル指定</a></li>
<li class='idx_x'><a class='autolink' href='#cPmXTXvPhJd'>コメント</a></li>
<li class='idx_x'><a class='autolink' href='#9Z7pya1EZOR'>システム変数</a></li>
<li class='idx_x'><a class='autolink' href='#dOeJnU6OE95'>スタイルスタック</a></li>
<li class='idx_x'><a class='autolink' href='#hVp0EDLBsmJ'>スタイルパレット</a></li>
<li class='idx_x'><a class='autolink' href='#g6xjP526KX7'>テーブル</a></li>
<li class='idx_x'><a class='autolink' href='#f71ZNSHqufB'>フィルタ機能</a></li>
<li class='idx_x'><a class='autolink' href='#18dTPnzNOgg'>外部フィルタ</a></li>
<li class='idx_x'><a class='autolink' href='#9PbJaRizVB7'>定義リスト</a></li>
<li class='idx_x'><a class='autolink' href='#2c4WKrG50Sg'>引用</a></li>
<li class='idx_x'><a class='autolink' href='#i9uAZw3xFSK'>拡張機能</a></li>
<li class='idx_x'><a class='autolink' href='#8tTIqHSNoTg'>既知の問題点</a></li>
<li class='idx_x'><a class='autolink' href='#8sNFPrNb9kM'>条件分岐</a></li>
<li class='idx_x'><a class='term' href='#8sf6EgPf8j8'>空白類文字</a></li>
<li class='idx_x'><a class='autolink' href='#2C50p0Hw1s1'>索引の生成</a></li>
<li class='idx_x'><a class='autolink' href='#9Dfk88hOKmk'>脚注</a></li>
<li class='idx_x'><a class='autolink' href='#7HkxqP1TWY5'>見出し</a></li>
</blockquote>
</details>
<p>　　</p>
<hr>
<p class='footnote'><a name='footnote1' href='#footnote_ref1'>1</a> : turnupという名前は、mark down を mark up にひっくり返す(turn upする)という意味で付けられました。</p>
<p class='footnote'><a name='footnote2' href='#footnote_ref2'>2</a> : <a href='https://daringfireball.net/projects/markdown/'>https://daringfireball.net/projects/markdown/</a></p>
<p class='footnote'><a name='footnote3' href='#footnote_ref3'>3</a> :  <code>GitHub Flavored Markdown</code> とか色々あるみたいで、何が標準なのか良くわかりませんが。</p>
<p class='footnote'><a name='footnote4' href='#footnote_ref4'>4</a> : スペースまたはタブで始まる行を pre ブロックとする仕様は採用していません</p>
<p class='footnote'><a name='footnote5' href='#footnote_ref5'>5</a> : = と - を混在させた場合、従来通り nowrap ではないものとみなされます。</p>
<p class='footnote'><a name='footnote6' href='#footnote_ref6'>6</a> : <a href='#hVp0EDLBsmJ'>スタイルパレット</a> の指定も含め、複数の指定を同時にする場合、 <code>|N]M&gt;U^</code> の順序で指定してください。</p>
<p class='footnote'><a name='footnote7' href='#footnote_ref7'>7</a> : <a class='term' href='#fgvQnqibuC4'>GFM</a> だと URL を単純に書いただけでもリンクになるようですが、そこまではしてません。</p>
<p class='footnote'><a name='footnote8' href='#footnote_ref8'>8</a> :  <code>@((STYLES)(CONTENTS))</code> 形式は、<a class='autolink' href='#9Dfk88hOKmk'>脚注</a>の中での使用を可能にするために追加されました</p>
<p class='footnote'><a name='footnote9' href='#footnote_ref9'>9</a> : <a class='autolink' href='#g6xjP526KX7'>テーブル</a>以外でパレットが必要な書法は無いような気がしています。ひょっとしたら、リストでやるかもしれません。</p>
<p class='footnote'><a name='footnote10' href='#footnote_ref10'>10</a> : この自動リンクにおいて、大文字小文字が異なる表記は対象になりません。この挙動を変更するオプションは今のところ、ありません。</p>
<p class='footnote'><a name='footnote11' href='#footnote_ref11'>11</a> : 自動リンクが<a class='autolink' href='#9PbJaRizVB7'>定義リスト</a>だけだった version 0.811 以前は、<a class='autolink' href='#9PbJaRizVB7'>定義リスト</a>で用語を重複させてもエラーにならない問題がありましたが、<a class='autolink' href='#8mg4uLSAXaz'>autolink</a> 導入にあわせて修正してあります。</p>
<p class='footnote'><a name='footnote12' href='#footnote_ref12'>12</a> : C/C++ のコードハイライト実装で基本的な仕組みはできているので、必要に応じて他も実装する予定です。</p>
<p class='footnote'><a name='footnote13' href='#footnote_ref13'>13</a> :  <code>tab</code> 以外で２文字以上の文字列を指定した場合、警告を出力した上で先頭の文字列が使用されます</p>
<p class='footnote'><a name='footnote14' href='#footnote_ref14'>14</a> : version 0.805 以前の実装では、「実行時のカレントディレクトリ」が最優先で検索される仕様でしたが、これは改められました。現在では、最優先されるのは常に「処理中のファイルがあるその場所」になります。</p>
<p class='footnote'><a name='footnote15' href='#footnote_ref15'>15</a> : 実際には、これは <code>&lt;p class='pagebreak'&gt;&lt;/p&gt;</code> という一行を出力 <a class='term' href='#ahN3t8jbawv'>HTML</a> に書き出すだけで、これが改ページとして機能するのは、CSS の設定によるものです。詳細は同梱の default.css に含まれる <code>p.pagebreak</code> という CSS エントリを参照してください。</p>
<p class='footnote'><a name='footnote16' href='#footnote_ref16'>16</a> : markdown 書法のコードハイライトに対応したエディタを使用していたり、そのエディタにプレビュー機能があったりすると、どちらかを選択する理由になるかもしれません（どっちかはわかりませんが）。</p>
<p class='footnote'><a name='footnote17' href='#footnote_ref17'>17</a> : 番号付けの書式は今のところこれだけで、選択はできません。</p>
<p class='footnote'><a name='footnote18' href='#footnote_ref18'>18</a> : それの何が嬉しいのかわからないかもしれませんが、作者にも良くわからない機能なので気にしないでください。おそらく、どのような設定で turnup が動作したのかわかるように、とかだと思います。</p>
<p class='footnote'><a name='footnote19' href='#footnote_ref19'>19</a> : アスキーアートと使うなと言ってるんじゃないですよ。</p>
<p class='footnote'><a name='footnote20' href='#footnote_ref20'>20</a> : <a href='https://plantuml.com/'>https://plantuml.com/</a></p>
<p class='footnote'><a name='footnote21' href='#footnote_ref21'>21</a> : turnup が「全部テキストで」なんとかしようとしているのには理由が２つあります。１つめは git などのバージョン管理システムでの管理を容易にすることで、２つめは「出力としてのドキュメントも単一にしたい」というものです。</p>
</body>
</html>
